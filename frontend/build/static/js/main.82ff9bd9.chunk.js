(this["webpackJsonpconfident-kids-app-frontend"]=this["webpackJsonpconfident-kids-app-frontend"]||[]).push([[0],{14:function(e,t,s){},31:function(e,t,s){},32:function(e,t,s){},33:function(e,t,s){},34:function(e,t,s){},35:function(e,t,s){},36:function(e,t,s){},37:function(e,t,s){},56:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),r=s(10),i=s.n(r),n=s(3),l=s(5),o=s(0);const d=Object(a.createContext)(),j="https://confident-kids-api.kevin-mcgovern.workers.dev",h=()=>Object(a.useContext)(d);function b(e){let{children:t}=e;const[s,c]=Object(a.useState)(null),[r,i]=Object(a.useState)(null),[n,l]=Object(a.useState)(!0),[h,b]=Object(a.useState)(""),[m,u]=Object(a.useState)(!1);async function O(){try{const e=localStorage.getItem("authToken");if(!e||!s)return i(null),null;console.log("Fetching subscription status");const t=await fetch(`${j}/api/subscriptions/status`,{method:"GET",headers:{Authorization:`Bearer ${e}`}}),a=await t.json();if(console.log("Subscription status response:",a),!t.ok)throw new Error(a.message||"Failed to fetch subscription status");return i(a.subscription),a.subscription}catch(h){return console.error("Error fetching subscription status:",h),i(null),null}}Object(a.useEffect)((()=>{let e=!0;return async function(){try{if(localStorage.getItem("authToken")){const t=await async function(){try{const e=localStorage.getItem("authToken");if(!e)return c(null),u(!1),l(!1),null;console.log("Fetching user profile with token:",e.substring(0,10)+"...");const t=await fetch(`${j}/api/users/profile`,{method:"GET",headers:{Authorization:`Bearer ${e}`}}),s=await t.json();if(console.log("User profile response:",s),!t.ok){if(401===t.status)return localStorage.removeItem("authToken"),c(null),u(!1),l(!1),null;throw new Error(s.message||"Failed to fetch user profile")}const a=s.user||s;return c(a),u(!0),a}catch(h){return console.error("Error fetching current user:",h),localStorage.removeItem("authToken"),c(null),u(!1),null}}();e&&(console.log("Setting current user:",t),c(t),u(!!t),t&&await O())}else e&&(console.log("No token found, clearing user state"),c(null),u(!1))}catch(h){console.error("Error loading user data:",h),e&&(c(null),u(!1))}finally{e&&l(!1)}}(),()=>{e=!1}}),[]);const p={currentUser:s,userSubscription:r,loading:n,error:h,isAuthenticated:m,register:async function(e,t,s){try{b(""),console.log("Registering with:",{email:e,name:s}),console.log("Using API URL:",j);const a=await fetch(`${j}/api/users/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,name:s})}),r=await a.json();if(console.log("Register response:",r),!a.ok)throw new Error(r.message||"Failed to register");return localStorage.setItem("authToken",r.token),c(r.user),u(!0),r}catch(h){throw console.error("Registration error:",h),b(h.message),h}},login:async function(e,t){try{b(""),console.log("Logging in with:",{email:e}),console.log("Using API URL:",j);const s=await fetch(`${j}/api/users/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await s.json();if(console.log("Login response:",a),!s.ok)throw new Error(a.message||"Failed to login");return localStorage.setItem("authToken",a.token),c(a.user),u(!0),console.log("Auth state after login:",{user:a.user,isAuthenticated:!0}),await O(),a}catch(h){throw console.error("Login error:",h),b(h.message),h}},logout:async function(){try{return b(""),localStorage.removeItem("authToken"),c(null),i(null),u(!1),!0}catch(h){throw b(h.message),h}},updateProfile:async function(e){try{b("");const t=localStorage.getItem("authToken");if(!t)throw new Error("Not authenticated");const s=await fetch(`${j}/api/users/update`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}),a=await s.json();if(!s.ok)throw new Error(a.message||"Failed to update profile");return c((e=>({...e,...a.user}))),a}catch(h){throw b(h.message),h}},hasPremiumAccess:function(){return r&&"active"===r.status},fetchSubscriptionStatus:O};return console.log("AuthContext state:",{isAuthenticated:m,hasUser:!!s,hasSubscription:!!r,loading:n,currentUser:s}),Object(o.jsx)(d.Provider,{value:p,children:t})}const m=Object(a.createContext)(),u=()=>Object(a.useContext)(m),O=e=>{let{children:t}=e;const[s,c]=Object(a.useState)(null);Object(a.useEffect)((()=>{const e=localStorage.getItem("activeChildId");e&&c(e)}),[]),Object(a.useEffect)((()=>{s?localStorage.setItem("activeChildId",s):localStorage.removeItem("activeChildId")}),[s]);const r={activeChild:s,setActiveChild:c};return Object(o.jsx)(m.Provider,{value:r,children:t})};s(14);var p=s(4),x=s.p+"static/media/logo.0f63a7c9.png";var g=()=>{const[e,t]=Object(a.useState)(!1),{currentUser:s,logout:c,userSubscription:r}=h(),i=Object(n.o)();Object(a.useEffect)((()=>{t(!1)}),[i]);return Object(o.jsx)("nav",{className:"navbar",children:Object(o.jsxs)("div",{className:"navbar-container",children:[Object(o.jsxs)(l.b,{to:"/",className:"navbar-logo",children:[Object(o.jsx)("img",{src:x,alt:"Confident Kids Logo"}),Object(o.jsx)("span",{children:"Confident Kids"})]}),Object(o.jsx)("button",{className:"navbar-toggle",onClick:()=>{t(!e)},"aria-label":"Toggle navigation",children:e?Object(o.jsx)(p.s,{}):Object(o.jsx)(p.b,{})}),Object(o.jsxs)("ul",{className:"navbar-menu "+(e?"active":""),children:[Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsx)(l.b,{to:"/",className:"navbar-link "+("/"===i.pathname?"active":""),children:"Home"})}),s&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsx)(l.b,{to:"/dashboard",className:"navbar-link "+("/dashboard"===i.pathname?"active":""),children:"Dashboard"})}),Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsx)(l.b,{to:"/pillars",className:"navbar-link "+(i.pathname.includes("/pillars")?"active":""),children:"Pillars"})}),Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsx)(l.b,{to:"/challenges",className:"navbar-link "+("/challenges"===i.pathname?"active":""),children:"Challenges"})}),r&&"active"===r.status&&Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsxs)(l.b,{to:"/rewards",className:"navbar-link "+("/rewards"===i.pathname?"active":""),children:["Rewards",Object(o.jsx)("span",{className:"premium-badge",children:"PRO"})]})}),Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsxs)(l.b,{to:"/profile",className:"navbar-link "+("/profile"===i.pathname?"active":""),children:[Object(o.jsx)(p.v,{})," Profile"]})}),Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsxs)("button",{onClick:async()=>{try{await c()}catch(e){console.error("Failed to log out",e)}},className:"navbar-link",children:[Object(o.jsx)(p.q,{})," Logout"]})})]}),!s&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsx)(l.b,{to:"/about",className:"navbar-link "+("/about"===i.pathname?"active":""),children:"About"})}),Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsx)(l.b,{to:"/login",className:"navbar-link "+("/login"===i.pathname?"active":""),children:"Login"})}),Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsx)(l.b,{to:"/register",className:"navbar-cta",children:"Sign Up"})})]}),s&&"active"===!(null!==r&&void 0!==r&&r.status)&&Object(o.jsx)("li",{className:"navbar-item",children:Object(o.jsxs)(l.b,{to:"/subscription",className:"navbar-cta",children:[Object(o.jsx)(p.i,{})," Upgrade"]})})]})]})})};var v=()=>{const[e,t]=Object(a.useState)(""),[s,c]=Object(a.useState)(""),[r,i]=Object(a.useState)(""),[d,j]=Object(a.useState)(!1),{login:b}=h(),m=Object(n.q)();return Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("div",{className:"row justify-content-center",children:Object(o.jsx)("div",{className:"col-md-6",children:Object(o.jsxs)("div",{className:"card mt-5",children:[Object(o.jsx)("div",{className:"card-header",children:Object(o.jsx)("h2",{className:"text-center",children:"Log In"})}),Object(o.jsxs)("div",{className:"card-body",children:[r&&Object(o.jsx)("div",{className:"alert alert-danger",role:"alert",children:r}),Object(o.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{i(""),j(!0),await b(e,s),m("/dashboard")}catch(r){i(r.message||"Failed to log in")}finally{j(!1)}},children:[Object(o.jsxs)("div",{className:"form-group mb-3",children:[Object(o.jsxs)("label",{htmlFor:"email",children:[Object(o.jsx)(p.k,{className:"me-2"})," Email"]}),Object(o.jsx)("input",{type:"email",id:"email",className:"form-control",value:e,onChange:e=>t(e.target.value),required:!0})]}),Object(o.jsxs)("div",{className:"form-group mb-4",children:[Object(o.jsxs)("label",{htmlFor:"password",children:[Object(o.jsx)(p.l,{className:"me-2"})," Password"]}),Object(o.jsx)("input",{type:"password",id:"password",className:"form-control",value:s,onChange:e=>c(e.target.value),required:!0})]}),Object(o.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:d,children:d?"Logging In...":"Log In"})]}),Object(o.jsx)("div",{className:"text-center mt-3",children:Object(o.jsx)(l.b,{to:"/forgot-password",children:"Forgot Password?"})})]}),Object(o.jsxs)("div",{className:"card-footer text-center",children:["Need an account? ",Object(o.jsx)(l.b,{to:"/register",children:"Sign Up"})]})]})})})})};var f=()=>{const[e,t]=Object(a.useState)(""),[s,c]=Object(a.useState)(""),[r,i]=Object(a.useState)(""),[d,j]=Object(a.useState)(""),[b,m]=Object(a.useState)(""),[u,O]=Object(a.useState)(!1),{register:x}=h(),g=Object(n.q)();return Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("div",{className:"row justify-content-center",children:Object(o.jsx)("div",{className:"col-md-6",children:Object(o.jsxs)("div",{className:"card mt-5",children:[Object(o.jsx)("div",{className:"card-header",children:Object(o.jsx)("h2",{className:"text-center",children:"Create Your Account"})}),Object(o.jsxs)("div",{className:"card-body",children:[b&&Object(o.jsx)("div",{className:"alert alert-danger",role:"alert",children:b}),Object(o.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),r!==d)return m("Passwords do not match");if(r.length<6)return m("Password must be at least 6 characters");try{m(""),O(!0),await x(s,r,e),g("/dashboard")}catch(b){m(b.message||"Failed to create an account")}finally{O(!1)}},children:[Object(o.jsxs)("div",{className:"form-group mb-3",children:[Object(o.jsxs)("label",{htmlFor:"name",children:[Object(o.jsx)(p.v,{className:"me-2"})," Full Name"]}),Object(o.jsx)("input",{type:"text",id:"name",className:"form-control",value:e,onChange:e=>t(e.target.value),required:!0})]}),Object(o.jsxs)("div",{className:"form-group mb-3",children:[Object(o.jsxs)("label",{htmlFor:"email",children:[Object(o.jsx)(p.k,{className:"me-2"})," Email"]}),Object(o.jsx)("input",{type:"email",id:"email",className:"form-control",value:s,onChange:e=>c(e.target.value),required:!0})]}),Object(o.jsxs)("div",{className:"form-group mb-3",children:[Object(o.jsxs)("label",{htmlFor:"password",children:[Object(o.jsx)(p.l,{className:"me-2"})," Password"]}),Object(o.jsx)("input",{type:"password",id:"password",className:"form-control",value:r,onChange:e=>i(e.target.value),required:!0})]}),Object(o.jsxs)("div",{className:"form-group mb-4",children:[Object(o.jsxs)("label",{htmlFor:"confirmPassword",children:[Object(o.jsx)(p.l,{className:"me-2"})," Confirm Password"]}),Object(o.jsx)("input",{type:"password",id:"confirmPassword",className:"form-control",value:d,onChange:e=>j(e.target.value),required:!0})]}),Object(o.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:u,children:u?"Creating Account...":"Sign Up"})]})]}),Object(o.jsxs)("div",{className:"card-footer text-center",children:["Already have an account? ",Object(o.jsx)(l.b,{to:"/login",children:"Log In"})]})]})})})})};var N=()=>{const[e,t]=Object(a.useState)(null),[s,c]=Object(a.useState)(null),[r,i]=Object(a.useState)(!0),[n,d]=Object(a.useState)(""),{currentUser:j,hasPremiumAccess:b}=h(),m=b();Object(a.useEffect)((()=>{console.log("Dashboard: currentUser changed",j)}),[j]),Object(a.useEffect)((()=>{var e;(null===j||void 0===j||null===(e=j.children)||void 0===e?void 0:e.length)>0&&!s&&(console.log("Dashboard: Setting initial child",j.children[0]),c(j.children[0].id))}),[j,s]),Object(a.useEffect)((()=>{let e=!0;return(async()=>{try{i(!0);const a=localStorage.getItem("authToken");if(!a)throw new Error("No authentication token found");const c=s?`https://confident-kids-api.kevin-mcgovern.workers.dev/api/dashboard?childId=${s}`:"https://confident-kids-api.kevin-mcgovern.workers.dev/api/dashboard";console.log("Dashboard: Fetching data for child:",s||"no child selected");const r=await fetch(c,{method:"GET",headers:{Authorization:`Bearer ${a}`}}),n=await r.json();if(console.log("Dashboard: Received data:",n),!r.ok)throw new Error(n.message||"Failed to fetch dashboard data");e&&(t(n),n.todayChallenge&&console.log("Daily challenge status:",{childId:s,challengeId:n.todayChallenge.id,completed:n.todayChallenge.completed}))}catch(n){console.error("Error fetching dashboard data:",n),e&&d(`Failed to load dashboard data${s?" for selected child":""}. Please try again later.`)}finally{e&&i(!1)}})(),()=>{e=!1}}),[s]);return r?Object(o.jsx)("div",{className:"text-center p-5",children:"Loading dashboard data..."}):n?Object(o.jsx)("div",{className:"alert alert-danger",children:n}):e?j?Object(o.jsxs)("div",{className:"container mt-4",children:[Object(o.jsxs)("div",{className:"dashboard-welcome",children:[Object(o.jsxs)("h1",{children:["Welcome, ",j.name,"!"]}),Object(o.jsx)("p",{children:"Track your child's confidence journey and explore activities designed to build their confidence."})]}),j.children&&j.children.length>0?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"child-selector mb-4",children:[Object(o.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(o.jsx)("select",{id:"childSelect",className:"form-control",value:s,onChange:e=>{c(e.target.value)},children:j.children.map((e=>Object(o.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}),s?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"dashboard-stats",children:[Object(o.jsxs)("div",{className:"stat-card",children:[Object(o.jsx)(p.d,{className:"mb-2",size:24}),Object(o.jsxs)("div",{className:"stat-value",children:[e.overallProgress,"%"]}),Object(o.jsx)("div",{className:"stat-label",children:"Overall Progress"})]}),Object(o.jsxs)("div",{className:"stat-card",children:[Object(o.jsx)(p.c,{className:"mb-2",size:24}),Object(o.jsx)("div",{className:"stat-value",children:e.activitiesCompleted}),Object(o.jsx)("div",{className:"stat-label",children:"Activities Completed"})]}),Object(o.jsxs)("div",{className:"stat-card",children:[Object(o.jsx)(p.u,{className:"mb-2",size:24}),Object(o.jsx)("div",{className:"stat-value",children:m?e.points:"Locked"}),Object(o.jsxs)("div",{className:"stat-label",children:["Reward Points ",!m&&Object(o.jsx)("span",{className:"premium-badge",children:"PRO"})]})]})]}),Object(o.jsxs)("div",{className:"today-challenge",children:[Object(o.jsx)("h2",{children:"Today's Challenge"}),Object(o.jsxs)("div",{className:"challenge-container",children:[Object(o.jsx)("h3",{className:"challenge-title",children:e.todayChallenge.title}),Object(o.jsx)("p",{className:"challenge-description",children:e.todayChallenge.description}),e.todayChallenge.completed?Object(o.jsxs)("div",{className:"completed-message",children:[Object(o.jsx)("span",{className:"completed-badge",children:"Completed"}),Object(o.jsx)("p",{children:"Great job! Come back tomorrow for a new challenge."}),Object(o.jsx)(l.b,{to:"/challenges",className:"btn btn-secondary mt-3",children:"View All Challenges"})]}):Object(o.jsx)(l.b,{to:`/challenges/${e.todayChallenge.id}`,className:"btn btn-primary mt-3",children:"Start Challenge"})]})]}),Object(o.jsx)("h2",{className:"mt-5 mb-3",children:"Confidence Pillars"}),Object(o.jsx)("div",{className:"grid-3",children:e.pillars.map((e=>Object(o.jsxs)("div",{className:`pillar-card pillar-card-${e.id}`,children:[Object(o.jsx)("div",{className:"pillar-card-header",children:Object(o.jsx)("h3",{children:e.name})}),Object(o.jsxs)("div",{className:"pillar-card-body",children:[Object(o.jsx)("p",{children:e.shortDescription}),Object(o.jsxs)("div",{className:"progress-label",children:[Object(o.jsx)("span",{children:"Progress"}),Object(o.jsxs)("span",{children:[e.progress,"%"]})]}),Object(o.jsx)("div",{className:"progress-container",children:Object(o.jsx)("div",{className:`progress-bar progress-bar-${e.id}`,style:{width:`${e.progress}%`}})})]}),Object(o.jsxs)("div",{className:"pillar-card-footer",children:[Object(o.jsxs)("span",{children:[e.activitiesCompleted,"/",e.totalActivities," Activities"]}),Object(o.jsx)(l.b,{to:`/pillars/${e.id}`,className:"btn btn-sm btn-outline",children:"Explore"})]})]},e.id)))})]}):Object(o.jsxs)("div",{className:"alert alert-info mt-4",children:[Object(o.jsx)("h4",{children:"Select a Child"}),Object(o.jsx)("p",{children:"Please select a child from the dropdown above to view their dashboard."})]})]}):Object(o.jsxs)("div",{className:"alert alert-info mt-4",children:[Object(o.jsx)("h4",{children:"Let's Get Started!"}),Object(o.jsx)("p",{children:"Add your child's profile to begin their confidence journey."}),Object(o.jsx)(l.b,{to:"/profile",className:"btn btn-primary mt-2",children:"Add Child Profile"})]}),!m&&Object(o.jsxs)("div",{className:"upgrade-prompt standard mt-5",children:[Object(o.jsxs)("h3",{children:[Object(o.jsx)(p.i,{className:"me-2"})," Unlock Premium Features"]}),Object(o.jsx)("p",{children:"Subscribe to our premium plan to access all activities, detailed progress tracking, and rewards for your child."}),Object(o.jsx)(l.b,{to:"/subscription",className:"upgrade-button",children:"Upgrade Now"})]})]}):Object(o.jsxs)("div",{className:"container mt-4",children:[Object(o.jsxs)("div",{className:"dashboard-welcome",children:[Object(o.jsx)("h1",{children:"Welcome!"}),Object(o.jsx)("p",{children:"Track your child's confidence journey and explore activities designed to build their confidence."})]}),Object(o.jsxs)("div",{className:"alert alert-info mt-4",children:[Object(o.jsx)("h4",{children:"Let's Get Started!"}),Object(o.jsx)("p",{children:"Add your child's profile to begin their confidence journey."}),Object(o.jsx)(l.b,{to:"/profile",className:"btn btn-primary mt-2",children:"Add Child Profile"})]})]}):Object(o.jsx)("div",{className:"text-center p-5",children:"No dashboard data available."})};s(31);s(32);var w=()=>{const{currentUser:e}=h(),{activeChild:t,setActiveChild:s}=u();return e?e.children&&0!==e.children.length?Object(o.jsxs)("div",{className:"child-selector",children:[Object(o.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(o.jsxs)("select",{id:"childSelect",className:"form-control",value:t||"",onChange:e=>s(e.target.value),children:[Object(o.jsx)("option",{value:"",children:"Select a child..."}),e.children.map((e=>Object(o.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))]})]}):Object(o.jsx)("div",{className:"child-selector",children:Object(o.jsxs)("div",{className:"alert alert-info",children:[Object(o.jsx)("p",{children:"No children added yet."}),Object(o.jsx)(l.b,{to:"/profile",className:"btn btn-primary btn-sm mt-2",children:"Add a Child"})]})}):null};s(33);const y="https://confident-kids-api.kevin-mcgovern.workers.dev";var k=()=>{const{currentUser:e,loading:t}=h(),{activeChild:s}=u(),[c,r]=Object(a.useState)([]),[i,n]=Object(a.useState)([]),[d,j]=Object(a.useState)([]),[b,m]=Object(a.useState)([]),[O,p]=Object(a.useState)(!0),[x,g]=Object(a.useState)("");return Object(a.useEffect)((()=>{(async()=>{if(!e)return console.log("No user found"),void p(!1);if(!e.children||0===e.children.length)return console.log("User has no children"),void p(!1);if(!s)return console.log("No child selected"),void p(!1);try{p(!0);const e=localStorage.getItem("authToken");if(console.log("Fetching data with token:",e?"Token exists":"No token"),console.log("Selected child:",s),!e)throw new Error("No authentication token found");const t=await fetch(`${y}/api/pillars?childId=${s}`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok){const e=await t.json();throw console.error("Pillars response error:",e),new Error(e.error||"Failed to fetch pillars data")}const a=await fetch(`${y}/api/content`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok){const e=await a.json();throw console.error("Content response error:",e),new Error(e.error||"Failed to fetch content data")}const c=await fetch(`${y}/api/challenges?childId=${s}`,{headers:{Authorization:`Bearer ${e}`}});if(!c.ok){const e=await c.json();throw console.error("Challenges response error:",e),new Error(e.error||"Failed to fetch challenges data")}const i=await fetch(`${y}/api/achievements?childId=${s}`,{headers:{Authorization:`Bearer ${e}`}});if(!i.ok){const e=await i.json();throw console.error("Achievements response error:",e),new Error(e.error||"Failed to fetch achievements data")}const[l,o,d,h]=await Promise.all([t.json(),a.json(),c.json(),i.json()]);r(l||[]),n(o||[]),j(d||[]),m(h||[]),g("")}catch(t){console.error("Error fetching data:",t),g(t.message)}finally{p(!1)}})()}),[e,s]),t||O?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"text-center p-5",children:"Loading pillars data..."})}):x?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"alert alert-danger",children:x})}):e&&e.children&&0!==e.children.length?Object(o.jsxs)("div",{className:"container mt-4",children:[Object(o.jsx)(w,{}),Object(o.jsx)("div",{className:"pillars-grid",children:c.map((e=>Object(o.jsxs)("div",{className:"pillar-card",children:[Object(o.jsx)("h3",{children:e.name}),Object(o.jsxs)("div",{className:"pillar-progress",children:[Object(o.jsx)("div",{className:"progress-bar",style:{width:`${e.progress||0}%`}}),Object(o.jsxs)("span",{className:"progress-text",children:[e.progress||0,"%"]})]}),Object(o.jsx)("p",{children:e.short_description}),Object(o.jsx)(l.b,{to:`/pillars/${e.id}`,className:"btn btn-primary",children:"View Details"})]},e.id)))})]}):Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"alert alert-warning",children:"Please add a child to your profile to view pillars and progress."})})};s(34);var S=()=>{const{pillarId:e}=Object(n.s)(),{currentUser:t}=h(),[s,c]=Object(a.useState)([]),[r,i]=Object(a.useState)(!0),[l,d]=Object(a.useState)(null),[j,b]=Object(a.useState)(null);Object(a.useEffect)((()=>{t&&t.children&&t.children.length>0&&!j&&b(t.children[0].id)}),[t]),Object(a.useEffect)((()=>{(async()=>{if(t&&j)try{i(!0),d(null);const t=localStorage.getItem("authToken");if(!t)throw new Error("No authentication token found");const s=await fetch(`https://confident-kids-api.kevin-mcgovern.workers.dev/api/pillars/${e}/techniques?childId=${j}`,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error("Failed to fetch techniques");const a=await s.json();c(a.techniques||[])}catch(s){d(s.message)}finally{i(!1)}})()}),[e,t,j]);return t?r?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"text-center p-5",children:"Loading techniques..."})}):l?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"alert alert-danger",children:l})}):Object(o.jsxs)("div",{className:"container mt-4",children:[Object(o.jsxs)("div",{className:"child-selector mb-4",children:[Object(o.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(o.jsx)("select",{id:"childSelect",className:"form-control",value:j||"",onChange:e=>{const t=e.target.value;b(t)},children:t.children.map((e=>Object(o.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}),Object(o.jsx)("div",{className:"techniques-grid",children:s.map((e=>Object(o.jsxs)("div",{className:"technique-card",children:[Object(o.jsx)("h3",{children:e.title}),Object(o.jsxs)("div",{className:"technique-meta",children:[Object(o.jsxs)("span",{className:"difficulty",children:[Object(o.jsx)(p.r,{})," ",1===e.difficulty_level?"Easy":2===e.difficulty_level?"Medium":"Hard"]}),Object(o.jsxs)("span",{className:"duration",children:[Object(o.jsx)(p.g,{})," ",e.duration," minutes"]}),Object(o.jsxs)("span",{className:"age-range",children:[Object(o.jsx)(p.w,{})," ","all"===e.age_group?"All Ages":e.age_group]})]}),Object(o.jsx)("p",{children:e.description}),Object(o.jsxs)("div",{className:"technique-steps",children:[Object(o.jsx)("h4",{children:"Steps:"}),Object(o.jsx)("ol",{children:e.steps.map(((e,t)=>Object(o.jsx)("li",{children:e},t)))})]}),e.tips&&Object(o.jsxs)("div",{className:"technique-tips",children:[Object(o.jsx)("h4",{children:"Tips:"}),Object(o.jsx)("ul",{children:e.tips.map(((e,t)=>Object(o.jsx)("li",{children:e},t)))})]})]},e.id)))})]}):Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"alert alert-warning",children:"Please log in to view techniques."})})},C=s(23),E=s(8);const $=Object(C.a)("pk_test_51R55ZbPEQoD1awJQndiLLj3BtKtvHxlcNTHTKEtS8kmXoUJugqf4P9r11ugn4A5UJnywb57E2T7776qPTJFkfKQ2000cVyNrVv"),P=[{id:"monthly",name:"Monthly",price:9.99,interval:"month",description:"Perfect for trying out all premium features",features:["Full access to all 5 pillars","Unlimited activities and challenges","Progress tracking for multiple children","Printable certificates","Rewards marketplace","Social sharing capabilities"]},{id:"yearly",name:"Yearly",price:89.99,regularPrice:119.88,interval:"year",description:"Our most popular plan",features:["Full access to all 5 pillars","Unlimited activities and challenges","Progress tracking for multiple children","Printable certificates","Rewards marketplace","Social sharing capabilities","Priority support","Early access to new features"],bestValue:!0},{id:"lifetime",name:"Lifetime",price:249.99,interval:"once",description:"Pay once, use forever",features:["Full access to all 5 pillars","Unlimited activities and challenges","Progress tracking for multiple children","Printable certificates","Rewards marketplace","Social sharing capabilities","Priority support","Early access to new features","All future updates included"]}],A=e=>{let{selectedPlan:t,onSuccess:s,onError:c}=e;const r=Object(E.useStripe)(),i=Object(E.useElements)(),{currentUser:n}=h(),[l,d]=Object(a.useState)(!1),[j,b]=Object(a.useState)(null);return Object(o.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r&&i){d(!0),b(null);try{const e=i.getElement(E.CardElement),{error:a,paymentMethod:c}=await r.createPaymentMethod({type:"card",card:e});if(a)throw new Error(a.message);const l=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/subscriptions/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({paymentMethodId:c.id,planId:t.id,customerId:n.id,email:n.email})}),o=await l.json();if(!l.ok)throw new Error(o.message||"Failed to process subscription");if("success"===o.status)s(o);else{if("requires_action"!==o.status)throw new Error(o.message||"Subscription failed");{const{error:e,paymentIntent:t}=await r.confirmCardPayment(o.clientSecret);if(e)throw new Error(e.message);if("succeeded"!==t.status)throw new Error("Payment failed");s(o)}}}catch(j){console.error("Subscription error:",j),b(j.message),c(j.message)}finally{d(!1)}}},children:[Object(o.jsx)("div",{className:"card-element-container",children:Object(o.jsx)(E.CardElement,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}})}),j&&Object(o.jsx)("div",{className:"alert alert-danger mb-3",children:j}),Object(o.jsx)("button",{type:"submit",className:"subscribe-button",disabled:!r||l,children:l?"Processing...":`Subscribe for $${t.price}/${"once"===t.interval?"":t.interval}`})]})};var T=()=>{const[e,t]=Object(a.useState)(P[1]),[s,c]=Object(a.useState)(!1),[r,i]=Object(a.useState)(null),{currentUser:l,userSubscription:d,fetchSubscriptionStatus:j}=h(),b=Object(n.q)();Object(a.useEffect)((()=>{d&&"active"===d.status&&b("/dashboard")}),[d,b]);return s?Object(o.jsx)("div",{className:"subscription-page",children:Object(o.jsxs)("div",{className:"success-message",children:[Object(o.jsxs)("h2",{children:[Object(o.jsx)(p.e,{className:"me-2"})," Subscription Successful!"]}),Object(o.jsx)("p",{children:"Thank you for subscribing to Confident Kids Premium. You now have access to all premium features."}),Object(o.jsx)("p",{children:"You will be redirected to your dashboard shortly..."})]})}):Object(o.jsxs)("div",{className:"subscription-page",children:[Object(o.jsxs)("div",{className:"feature-highlight",children:[Object(o.jsxs)("h1",{children:[Object(o.jsx)(p.i,{className:"me-2"})," Upgrade to Confident Kids Premium"]}),Object(o.jsx)("p",{children:"Unlock the full potential of your child's confidence journey with our premium features."})]}),Object(o.jsxs)("div",{className:"plan-selection",children:[Object(o.jsx)("h2",{children:"Choose Your Plan"}),Object(o.jsx)("div",{className:"plan-options",children:P.map((s=>Object(o.jsxs)("div",{className:"plan-card "+(e.id===s.id?"selected":""),onClick:()=>(e=>{t(e)})(s),children:[s.bestValue&&Object(o.jsx)("div",{className:"best-value",children:"Best Value"}),Object(o.jsx)("h3",{children:s.name}),Object(o.jsxs)("div",{className:"price",children:["$",s.price," ",Object(o.jsxs)("span",{children:["/","once"===s.interval?"":s.interval]})]}),s.regularPrice&&Object(o.jsxs)("div",{className:"savings",children:["Save $",(s.regularPrice-s.price).toFixed(2)," per year"]}),Object(o.jsx)("p",{children:s.description}),Object(o.jsx)("ul",{className:"features",children:s.features.map(((e,t)=>Object(o.jsx)("li",{children:e},t)))}),Object(o.jsx)("button",{className:`btn ${e.id===s.id?"btn-primary":"btn-outline"} w-100`,children:e.id===s.id?"Selected":"Select"})]},s.id)))})]}),Object(o.jsxs)("div",{className:"payment-section",children:[Object(o.jsx)("h2",{children:"Payment Information"}),Object(o.jsx)(E.Elements,{stripe:$,children:Object(o.jsx)(A,{selectedPlan:e,onSuccess:async e=>{c(!0),await j(),setTimeout((()=>{b("/dashboard")}),3e3)},onError:e=>{i(e)}})}),r&&Object(o.jsx)("div",{className:"alert alert-danger mt-3",children:r}),Object(o.jsxs)("div",{className:"guarantee",children:[Object(o.jsxs)("p",{children:[Object(o.jsx)(p.o,{})," 30-day money-back guarantee ",Object(o.jsx)(p.o,{})]}),Object(o.jsx)("p",{children:"If you're not satisfied with our premium features, we'll refund your payment within the first 30 days."})]})]})]})};var I=()=>{const[e,t]=Object(a.useState)("achievements"),[s,c]=Object(a.useState)([]),[r,i]=Object(a.useState)([]),[n,l]=Object(a.useState)([]),[d,j]=Object(a.useState)(0),[b,m]=Object(a.useState)(!0),[u,O]=Object(a.useState)(""),{currentUser:x,hasPremiumAccess:g}=h();Object(a.useEffect)((()=>{g()?(async()=>{try{m(!0);const e=localStorage.getItem("authToken"),t=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/rewards",{method:"GET",headers:{Authorization:`Bearer ${e}`}}),s=await t.json();if(!t.ok)throw new Error(s.message||"Failed to fetch rewards data");c(s.achievements),i(s.certificates),l(s.marketplace),j(s.points)}catch(u){console.error("Error fetching rewards data:",u),O("Failed to load rewards data. Please try again later.")}finally{m(!1)}})():m(!1)}),[g]);return g()?b?Object(o.jsx)("div",{className:"text-center p-5",children:"Loading rewards data..."}):u?Object(o.jsx)("div",{className:"alert alert-danger",children:u}):Object(o.jsxs)("div",{className:"rewards-container",children:[Object(o.jsx)("h1",{className:"mb-4",children:"Rewards & Achievements"}),Object(o.jsxs)("div",{className:"points-display",children:[Object(o.jsx)("span",{className:"points-icon",children:Object(o.jsx)(p.r,{})}),Object(o.jsxs)("span",{className:"points-value",children:[d," Points"]})]}),Object(o.jsxs)("div",{className:"rewards-tabs",children:[Object(o.jsx)("button",{className:"achievements"===e?"active":"",onClick:()=>t("achievements"),children:"Achievements"}),Object(o.jsx)("button",{className:"certificates"===e?"active":"",onClick:()=>t("certificates"),children:"Certificates"}),Object(o.jsx)("button",{className:"marketplace"===e?"active":"",onClick:()=>t("marketplace"),children:"Rewards Marketplace"})]}),Object(o.jsxs)("div",{className:"rewards-content",children:["achievements"===e&&Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{className:"mb-3",children:"Your Child's Achievements"}),Object(o.jsx)("div",{className:"achievement-grid",children:s.map((e=>Object(o.jsxs)("div",{className:"achievement-item "+(e.unlocked?"":"achievement-locked"),children:[Object(o.jsx)("div",{className:"achievement-icon",children:e.icon}),Object(o.jsx)("h4",{children:e.name}),Object(o.jsx)("p",{children:e.description}),e.unlocked?Object(o.jsx)("div",{className:"text-success",children:"Unlocked!"}):Object(o.jsxs)("div",{className:"text-muted",children:[e.progress,"% Complete"]})]},e.id)))})]}),"certificates"===e&&Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{className:"mb-3",children:"Printable Certificates"}),0===r.length?Object(o.jsx)("p",{children:"No certificates earned yet. Complete activities to earn certificates!"}):r.map((e=>{var t,s;return Object(o.jsxs)("div",{className:"mb-4",children:[Object(o.jsx)("h4",{children:e.title}),Object(o.jsx)("div",{className:"certificate-preview",children:Object(o.jsxs)("div",{className:"certificate-content",children:[Object(o.jsx)("h2",{children:e.title}),Object(o.jsxs)("h3",{children:["Awarded to: ",(null===(t=x.children)||void 0===t||null===(s=t.find((t=>t.id===e.childId)))||void 0===s?void 0:s.name)||"Your Child"]}),Object(o.jsx)("p",{children:e.description}),Object(o.jsxs)("p",{children:["Date: ",new Date(e.date).toLocaleDateString()]})]})}),Object(o.jsxs)("div",{className:"certificate-actions",children:[Object(o.jsxs)("button",{className:"btn btn-outline",onClick:()=>{return t=e.id,void console.log(`Sharing certificate ${t}`);var t},children:[Object(o.jsx)(p.p,{className:"me-2"})," Share"]}),Object(o.jsxs)("button",{className:"btn btn-primary print-button",onClick:()=>{return t=e.id,console.log(`Printing certificate ${t}`),void window.print();var t},children:[Object(o.jsx)(p.n,{className:"me-2"})," Print"]})]})]},e.id)}))]}),"marketplace"===e&&Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{className:"mb-3",children:"Rewards Marketplace"}),Object(o.jsx)("p",{children:"Use your points to redeem these special rewards for your child:"}),Object(o.jsx)("div",{className:"marketplace-grid",children:n.map((e=>Object(o.jsxs)("div",{className:"reward-item",children:[Object(o.jsx)("img",{src:e.image,alt:e.name,className:"reward-image"}),Object(o.jsxs)("div",{className:"reward-content",children:[Object(o.jsxs)("div",{className:"reward-points",children:[e.points," Points"]}),Object(o.jsx)("h4",{children:e.name}),Object(o.jsx)("p",{children:e.description}),Object(o.jsx)("button",{className:"btn btn-primary w-100 mt-2",disabled:d<e.points||e.redeemed,onClick:()=>(async e=>{try{const t=localStorage.getItem("authToken"),s=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/rewards/redeem",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({rewardId:e})}),a=await s.json();if(!s.ok)throw new Error(a.message||"Failed to redeem reward");j(a.updatedPoints),l((t=>t.map((t=>t.id===e?{...t,redeemed:!0}:t)))),alert("Reward redeemed successfully!")}catch(u){console.error("Error redeeming reward:",u),alert(`Failed to redeem reward: ${u.message}`)}})(e.id),children:e.redeemed?"Redeemed":"Redeem Reward"})]})]},e.id)))})]})]})]}):Object(o.jsx)("div",{className:"container mt-5",children:Object(o.jsxs)("div",{className:"upgrade-prompt standard",children:[Object(o.jsxs)("h2",{children:[Object(o.jsx)(p.u,{className:"me-2"})," Unlock the Rewards System"]}),Object(o.jsx)("p",{children:"The Rewards System is a premium feature that allows your child to earn achievements, collect certificates, and redeem points for special rewards."}),Object(o.jsx)("p",{children:"Subscribe to our premium plan to motivate your child with tangible rewards for their confidence journey."}),Object(o.jsx)("a",{href:"/subscription",className:"upgrade-button",children:"Upgrade Now"})]})})};s(35);var F=()=>{const[e,t]=Object(a.useState)(null),[s,c]=Object(a.useState)(!0),[r,i]=Object(a.useState)(null),[n,l]=Object(a.useState)("profile"),[d,j]=Object(a.useState)({name:"",age:"",age_group:""}),[b,m]=Object(a.useState)(!1),[u,O]=Object(a.useState)(null),{currentUser:x,updateProfile:g}=h();Object(a.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("authToken");if(!e)throw new Error("No authentication token found");const s=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/users/profile",{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch profile");const a=await s.json();t(a.user||a)}catch(e){console.error("Error fetching profile:",e),i(e.message)}finally{c(!1)}})()}),[]);return s?Object(o.jsx)("div",{className:"loading",children:"Loading profile..."}):r?Object(o.jsx)("div",{className:"error",children:r}):e?Object(o.jsxs)("div",{className:"profile-container",children:[Object(o.jsxs)("div",{className:"profile-sidebar",children:[Object(o.jsxs)("div",{className:"profile-header",children:[Object(o.jsx)("div",{className:"profile-avatar",children:Object(o.jsx)(p.v,{})}),Object(o.jsx)("h2",{children:e.name}),Object(o.jsx)("p",{children:e.email})]}),Object(o.jsxs)("nav",{className:"profile-nav",children:[Object(o.jsxs)("button",{className:"nav-item "+("profile"===n?"active":""),onClick:()=>l("profile"),children:[Object(o.jsx)(p.v,{})," Profile"]}),Object(o.jsxs)("button",{className:"nav-item "+("children"===n?"active":""),onClick:()=>l("children"),children:[Object(o.jsx)(p.f,{})," Children"]}),Object(o.jsxs)("button",{className:"nav-item "+("settings"===n?"active":""),onClick:()=>l("settings"),children:[Object(o.jsx)(p.h,{})," Settings"]}),Object(o.jsxs)("button",{className:"nav-item "+("security"===n?"active":""),onClick:()=>l("security"),children:[Object(o.jsx)(p.l,{})," Security"]})]})]}),Object(o.jsxs)("div",{className:"profile-content",children:["profile"===n&&Object(o.jsxs)("div",{className:"profile-section",children:[Object(o.jsx)("h3",{children:"Profile Information"}),Object(o.jsxs)("form",{onSubmit:async s=>{s.preventDefault();try{const s=localStorage.getItem("authToken");if(!s)throw new Error("No authentication token found");const a=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/users/update",{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw new Error("Failed to update profile");const c=await a.json();t(c.user||c),await g(c.user||c)}catch(a){console.error("Error updating profile:",a),i(a.message)}},children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Name"}),Object(o.jsx)("input",{type:"text",value:e.name,onChange:s=>t({...e,name:s.target.value})})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Email"}),Object(o.jsx)("input",{type:"email",value:e.email,onChange:s=>t({...e,email:s.target.value})})]}),Object(o.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"})]})]}),"children"===n&&Object(o.jsxs)("div",{className:"children-section",children:[Object(o.jsx)("h3",{children:"My Children"}),e.children&&e.children.length>0?Object(o.jsx)("div",{className:"children-grid",children:e.children.map((e=>Object(o.jsxs)("div",{className:"child-card",children:[Object(o.jsx)("div",{className:"child-avatar",children:Object(o.jsx)(p.f,{})}),Object(o.jsxs)("div",{className:"child-info",children:[Object(o.jsx)("h4",{children:e.name}),Object(o.jsxs)("p",{children:[e.age," years old"]}),Object(o.jsx)("p",{className:"age-group",children:e.age_group})]}),Object(o.jsxs)("div",{className:"child-actions",children:[Object(o.jsx)("button",{className:"btn btn-icon",onClick:()=>O(e),children:Object(o.jsx)(p.j,{})}),Object(o.jsx)("button",{className:"btn btn-icon btn-danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this child?"))try{const s=localStorage.getItem("authToken");if(!s)throw new Error("No authentication token found");if(!(await fetch(`https://confident-kids-api.kevin-mcgovern.workers.dev/api/children/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Failed to delete child");const a=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/users/profile",{headers:{Authorization:`Bearer ${s}`}});if(!a.ok)throw new Error("Failed to fetch updated profile");const c=await a.json();t(c.user||c)}catch(r){console.error("Error deleting child:",r),i(r.message)}})(e.id),children:Object(o.jsx)(p.t,{})})]})]},e.id)))}):Object(o.jsx)("p",{children:"You haven't added any children yet."}),Object(o.jsxs)("button",{className:"btn btn-secondary mt-4",onClick:()=>m(!b),children:[Object(o.jsx)(p.m,{className:"me-2"})," Add Child"]}),b&&Object(o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("authToken");if(!e)throw new Error("No authentication token found");let s;if(d.age>=2&&d.age<=5)s="Toddler";else if(d.age>=6&&d.age<=12)s="Elementary";else{if(!(d.age>=13&&d.age<=18))throw new Error("Age must be between 2 and 18");s="Teen"}const a=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/children",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...d,ageGroup:s})});if(!a.ok)throw new Error("Failed to add child");await a.json();const c=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/users/profile",{headers:{Authorization:`Bearer ${e}`}});if(!c.ok)throw new Error("Failed to fetch updated profile");const r=await c.json();t(r.user||r),j({name:"",age:""}),m(!1)}catch(r){console.error("Error adding child:",r),i(r.message)}},className:"add-child-form mt-4",children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Child's Name"}),Object(o.jsx)("input",{type:"text",value:d.name,onChange:e=>j({...d,name:e.target.value}),required:!0})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Age"}),Object(o.jsx)("input",{type:"number",min:"2",max:"18",value:d.age,onChange:e=>j({...d,age:e.target.value}),required:!0})]}),Object(o.jsxs)("div",{className:"form-actions",children:[Object(o.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Add Child"}),Object(o.jsx)("button",{type:"button",className:"btn btn-secondary ms-2",onClick:()=>m(!1),children:"Cancel"})]})]}),u&&Object(o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("authToken");if(!e)throw new Error("No authentication token found");let s;if(u.age>=2&&u.age<=5)s="Toddler";else if(u.age>=6&&u.age<=12)s="Elementary";else{if(!(u.age>=13&&u.age<=18))throw new Error("Age must be between 2 and 18");s="Teen"}if(!(await fetch(`https://confident-kids-api.kevin-mcgovern.workers.dev/api/children/${u.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...u,ageGroup:s})})).ok)throw new Error("Failed to update child");const a=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/users/profile",{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)throw new Error("Failed to fetch updated profile");const c=await a.json();t(c.user||c),O(null)}catch(r){console.error("Error updating child:",r),i(r.message)}},className:"add-child-form mt-4",children:[Object(o.jsx)("h4",{children:"Edit Child"}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Child's Name"}),Object(o.jsx)("input",{type:"text",value:u.name,onChange:e=>O({...u,name:e.target.value}),required:!0})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"Age"}),Object(o.jsx)("input",{type:"number",min:"2",max:"18",value:u.age,onChange:e=>O({...u,age:e.target.value}),required:!0})]}),Object(o.jsxs)("div",{className:"form-actions",children:[Object(o.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"}),Object(o.jsx)("button",{type:"button",className:"btn btn-secondary ms-2",onClick:()=>O(null),children:"Cancel"})]})]})]}),"settings"===n&&Object(o.jsxs)("div",{className:"settings-section",children:[Object(o.jsx)("h3",{children:"Account Settings"}),Object(o.jsxs)("div",{className:"settings-grid",children:[Object(o.jsxs)("div",{className:"setting-card",children:[Object(o.jsx)("h4",{children:"Language"}),Object(o.jsxs)("select",{value:e.language,onChange:s=>t({...e,language:s.target.value}),children:[Object(o.jsx)("option",{value:"en",children:"English"}),Object(o.jsx)("option",{value:"es",children:"Spanish"}),Object(o.jsx)("option",{value:"fr",children:"French"})]})]}),Object(o.jsxs)("div",{className:"setting-card",children:[Object(o.jsx)("h4",{children:"Theme"}),Object(o.jsxs)("select",{value:e.theme,onChange:s=>t({...e,theme:s.target.value}),children:[Object(o.jsx)("option",{value:"light",children:"Light"}),Object(o.jsx)("option",{value:"dark",children:"Dark"}),Object(o.jsx)("option",{value:"system",children:"System"})]})]})]})]}),"security"===n&&Object(o.jsxs)("div",{className:"security-section",children:[Object(o.jsx)("h3",{children:"Security Settings"}),Object(o.jsxs)("div",{className:"security-options",children:[Object(o.jsx)("button",{className:"btn btn-secondary",children:"Change Password"}),Object(o.jsx)("button",{className:"btn btn-secondary",children:"Enable Two-Factor Authentication"})]})]})]})]}):Object(o.jsx)("div",{className:"no-profile",children:"No profile data available"})};s(36);const U="https://confident-kids-api.kevin-mcgovern.workers.dev";var q=()=>{const{currentUser:e}=h(),{activeChild:t,setActiveChild:s}=u(),[c,r]=Object(a.useState)("daily"),[i,n]=Object(a.useState)(null),[l,d]=Object(a.useState)([]),[j,b]=Object(a.useState)(!0),[m,O]=Object(a.useState)(null),[x,g]=Object(a.useState)(new Set),[v,f]=Object(a.useState)([]),[N,y]=Object(a.useState)({completed:0,total:0,streak:0,currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear()});Object(a.useEffect)((()=>{e&&e.children&&e.children.length>0&&!t&&s(e.children[0].id)}),[e,s]),Object(a.useEffect)((()=>{(async()=>{if(e&&t)try{b(!0),O(null);const e=localStorage.getItem("authToken");if(!e)throw new Error("No authentication token found");const s=new Date,a=s.getMonth()+1,c=s.getFullYear(),r=await fetch(`${U}/api/challenges/daily?childId=${t}&month=${a}&year=${c}`,{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error("Failed to fetch daily challenge");const i=await r.json();n(i.challenge);const l=await fetch(`${U}/api/challenges/weekly?childId=${t}&month=${a}&year=${c}`,{headers:{Authorization:`Bearer ${e}`}});if(!l.ok)throw new Error("Failed to fetch weekly challenges");const o=await l.json();d(o.challenges);const j=await fetch(`${U}/api/challenges/completed?childId=${t}&month=${a}&year=${c}`,{headers:{Authorization:`Bearer ${e}`}});if(j.ok){const e=await j.json();g(new Set(e.completed_challenges.map((e=>e.id))))}const h=await fetch(`${U}/api/challenges/calendar?childId=${t}&month=${a}&year=${c}`,{headers:{Authorization:`Bearer ${e}`}});if(h.ok){const e=await h.json();f(e.challenges)}const m=await fetch(`${U}/api/progress?childId=${t}&month=${a}&year=${c}`,{headers:{Authorization:`Bearer ${e}`}});if(m.ok){const e=await m.json();y({completed:e.completedChallenges,total:e.totalChallenges,streak:e.streak||0,currentMonth:a,currentYear:c})}}catch(s){O(s.message)}finally{b(!1)}})()}),[e,t]);return e?j?Object(o.jsx)("div",{className:"loader",children:"Loading challenges..."}):m?Object(o.jsx)("div",{className:"alert alert-danger",children:m}):Object(o.jsxs)("div",{className:"challenges-page",children:[Object(o.jsxs)("div",{className:"challenges-header",children:[Object(o.jsx)("h1",{children:"30-Day Challenges"}),Object(o.jsx)(w,{})]}),t?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"progress-stats",children:[Object(o.jsxs)("div",{className:"stat-card",children:[Object(o.jsx)("h3",{children:"Completed"}),Object(o.jsx)("div",{className:"stat-number",children:N.completed})]}),Object(o.jsxs)("div",{className:"stat-card",children:[Object(o.jsx)("h3",{children:"Total"}),Object(o.jsx)("div",{className:"stat-number",children:N.total})]}),Object(o.jsxs)("div",{className:"stat-card",children:[Object(o.jsx)("h3",{children:"Streak"}),Object(o.jsx)("div",{className:"stat-number",children:N.streak})]})]}),Object(o.jsx)("div",{className:"challenges-grid",children:v.map((e=>Object(o.jsxs)("div",{className:"calendar-day "+(e.completed?"completed":""),children:[Object(o.jsxs)("div",{className:"day-number",children:["Day ",e.day]}),Object(o.jsxs)("div",{className:"day-content",children:[Object(o.jsx)("h3",{children:e.title}),Object(o.jsx)("p",{children:e.description}),!e.completed&&Object(o.jsx)("div",{className:"day-action",children:Object(o.jsx)("button",{className:"btn btn-primary",onClick:()=>(async e=>{if(t)try{const s=localStorage.getItem("authToken"),a=v.find((t=>t.day===e)),c=new Date,r=c.getMonth()+1,i=c.getFullYear(),n=await fetch(`${U}/api/challenges/${a.id}/complete`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({childId:t,completed:!0})});if(!n.ok)throw new Error(`Failed to update challenge status: ${n.statusText}`);f(v.map((t=>t.day===e?{...t,completed:!0}:t)));const l=await fetch(`${U}/api/progress?childId=${t}&month=${r}&year=${i}`,{headers:{Authorization:`Bearer ${s}`}});if(l.ok){const e=await l.json();y({completed:e.completedChallenges,total:e.totalChallenges,streak:e.streak||0,currentMonth:r,currentYear:i})}}catch(s){console.error("Error toggling calendar challenge:",s),O(s.message)}else O("No active child selected")})(e.day),children:"Complete"})}),e.completed&&Object(o.jsxs)("div",{className:"completed-state",children:[Object(o.jsx)(p.e,{}),Object(o.jsx)("span",{children:"Completed!"})]})]})]},e.id)))})]}):Object(o.jsx)("div",{className:"alert alert-info",children:"Please select a child to view their challenges."})]}):Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"alert alert-warning",children:"Please log in to view challenges."})})};s(37);const z="https://confident-kids-api.kevin-mcgovern.workers.dev";var B=()=>{const{challengeId:e}=Object(n.s)(),t=Object(n.q)(),{currentUser:s}=h(),[c,r]=Object(a.useState)(null),[i,l]=Object(a.useState)(!0),[d,j]=Object(a.useState)(null),[b,m]=Object(a.useState)(null);Object(a.useEffect)((()=>{s&&s.children&&s.children.length>0&&!b&&m(s.children[0].id)}),[s]),Object(a.useEffect)((()=>{(async()=>{if(s&&b)try{l(!0),j(null);const t=localStorage.getItem("authToken");if(!t)throw new Error("No authentication token found");const s=await fetch(`${z}/api/challenges/${e}`,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error("Failed to fetch challenge details");const a=await s.json();r(a)}catch(t){j(t.message)}finally{l(!1)}})()}),[e,s,b]);return s?i?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"text-center p-5",children:"Loading challenge details..."})}):d?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"alert alert-danger",children:d})}):c?Object(o.jsxs)("div",{className:"container mt-4",children:[Object(o.jsxs)("button",{className:"btn btn-outline-secondary mb-3",onClick:()=>t(-1),children:[Object(o.jsx)(p.a,{className:"me-2"})," Back to Challenges"]}),Object(o.jsxs)("div",{className:"daily-challenge",children:[s.children&&s.children.length>0&&Object(o.jsxs)("div",{className:"child-selector mb-4",children:[Object(o.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(o.jsx)("select",{id:"childSelect",className:"form-control",value:(null===b||void 0===b?void 0:b.id)||"",onChange:e=>{const t=e.target.value,a=s.children.find((e=>e.id===t));m(a)},children:s.children.map((e=>Object(o.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}),Object(o.jsxs)("div",{className:"challenge-header",children:[Object(o.jsx)("h2",{children:c.title}),Object(o.jsxs)("div",{className:"challenge-meta",children:[Object(o.jsxs)("span",{className:"difficulty",children:[Object(o.jsx)(p.r,{})," ",1===c.difficulty_level?"Easy":2===c.difficulty_level?"Medium":"Hard"]}),Object(o.jsxs)("span",{className:"duration",children:[Object(o.jsx)(p.g,{})," 15-20 minutes"]}),Object(o.jsxs)("span",{className:"age-range",children:[Object(o.jsx)(p.w,{})," ","all"===c.age_group?"All Ages":c.age_group]})]})]}),Object(o.jsxs)("div",{className:"challenge-content",children:[Object(o.jsx)("p",{className:"description",children:c.description}),Object(o.jsxs)("div",{className:"instructions",children:[Object(o.jsx)("h4",{children:"Instructions for Parents:"}),Object(o.jsx)("p",{children:c.instructions})]}),c.materials&&Object(o.jsxs)("div",{className:"materials",children:[Object(o.jsx)("h4",{children:"Materials Needed:"}),Object(o.jsx)("p",{children:c.materials})]}),Object(o.jsx)("div",{className:"challenge-actions",children:Object(o.jsxs)("button",{className:"btn "+(c.completed?"btn-secondary":"btn-primary"),onClick:async()=>{if(c&&b)try{const t=localStorage.getItem("authToken"),s=await fetch(`${z}/api/challenges/${e}/complete`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({childId:b,completed:!c.completed})});if(!s.ok)throw new Error("Failed to update challenge status");await s.json();r({...c,completed:!c.completed})}catch(t){j(t.message)}},children:[Object(o.jsx)(p.e,{className:"me-2"}),c.completed?"Mark as Incomplete":"Mark as Complete"]})})]})]})]}):Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"text-center p-5",children:"Challenge not found."})}):Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"alert alert-warning",children:"Please log in to view challenge details."})})};s(7);const L=Object(a.createContext)();var D=L;const R="https://confident-kids-api.kevin-mcgovern.workers.dev";var _=()=>{var e,t,s,c;const{id:r}=Object(n.s)(),{user:i}=Object(a.useContext)(D),[l,d]=Object(a.useState)("overview"),[j,h]=Object(a.useState)(null),[b,m]=Object(a.useState)([]),[u,O]=Object(a.useState)(!0),[p,x]=Object(a.useState)(null),[g,v]=Object(a.useState)(null);return Object(a.useEffect)((()=>{i&&i.children&&i.children.length>0&&!g&&v(i.children[0].id)}),[i]),Object(a.useEffect)((()=>{(async()=>{if(r&&g)try{O(!0),x(null);const e=await fetch(`${R}/api/pillars/${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!e.ok)throw new Error("Failed to fetch pillar data");const t=await e.json();h(t);const s=await fetch(`${R}/api/content?pillarId=${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!s.ok)throw new Error("Failed to fetch techniques");const a=await s.json();m(a.filter((e=>"technique"===e.content_type)))}catch(e){console.error("Error fetching pillar data:",e),x(e.message)}finally{O(!1)}})()}),[r,g]),u?Object(o.jsx)("div",{className:"container mt-4",children:"Loading pillar data..."}):p?Object(o.jsx)("div",{className:"container mt-4 alert alert-danger",children:p}):j?Object(o.jsxs)("div",{className:"container mt-4",children:[Object(o.jsxs)("div",{className:"child-selector mb-4",children:[Object(o.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(o.jsx)("select",{id:"childSelect",className:"form-control",value:g||"",onChange:e=>v(e.target.value),children:null===i||void 0===i||null===(e=i.children)||void 0===e?void 0:e.map((e=>Object(o.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}),Object(o.jsxs)("div",{className:"pillar-header",children:[Object(o.jsx)("h1",{children:j.name}),Object(o.jsx)("p",{className:"lead",children:j.short_description})]}),Object(o.jsxs)("div",{className:"pillar-tabs",children:[Object(o.jsx)("button",{className:"tab "+("overview"===l?"active":""),onClick:()=>d("overview"),children:"Overview"}),Object(o.jsx)("button",{className:"tab "+("techniques"===l?"active":""),onClick:()=>d("techniques"),children:"Techniques"}),Object(o.jsx)("button",{className:"tab "+("challenges"===l?"active":""),onClick:()=>d("challenges"),children:"Challenges"})]}),"overview"===l&&Object(o.jsxs)("div",{className:"pillar-overview",children:[Object(o.jsxs)("div",{className:"description",children:[Object(o.jsx)("h2",{children:"About This Pillar"}),Object(o.jsx)("p",{children:j.description})]}),Object(o.jsxs)("div",{className:"age-groups",children:[Object(o.jsx)("h2",{children:"Age-Specific Guidance"}),Object(o.jsxs)("div",{className:"age-group",children:[Object(o.jsx)("h3",{children:"Toddlers (2-5 years)"}),Object(o.jsx)("p",{children:(null===(t=j.age_groups)||void 0===t?void 0:t.toddler)||"Guidance coming soon"})]}),Object(o.jsxs)("div",{className:"age-group",children:[Object(o.jsx)("h3",{children:"Elementary (6-11 years)"}),Object(o.jsx)("p",{children:(null===(s=j.age_groups)||void 0===s?void 0:s.elementary)||"Guidance coming soon"})]}),Object(o.jsxs)("div",{className:"age-group",children:[Object(o.jsx)("h3",{children:"Teens (12+ years)"}),Object(o.jsx)("p",{children:(null===(c=j.age_groups)||void 0===c?void 0:c.teen)||"Guidance coming soon"})]})]})]}),"techniques"===l&&Object(o.jsx)("div",{className:"pillar-techniques",children:b.map((e=>{var t,s;return Object(o.jsxs)("div",{className:"technique-card",children:[Object(o.jsx)("h3",{children:e.title}),Object(o.jsx)("p",{children:e.description}),Object(o.jsxs)("div",{className:"technique-content",children:[Object(o.jsx)("h4",{children:"Instructions"}),Object(o.jsx)("p",{children:(null===(t=e.content_data)||void 0===t?void 0:t.instructions)||"Instructions coming soon"}),(null===(s=e.content_data)||void 0===s?void 0:s.examples)&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h4",{children:"Examples"}),Object(o.jsx)("ul",{children:e.content_data.examples.map(((e,t)=>Object(o.jsx)("li",{children:e},t)))})]})]})]},e.id)}))}),"challenges"===l&&Object(o.jsx)("div",{className:"pillar-challenges",children:Object(o.jsx)("p",{children:"Challenges for this pillar will be available soon."})})]}):Object(o.jsx)("div",{className:"container mt-4",children:"Pillar not found"})};const M=e=>{let{children:t}=e;const{currentUser:s,loading:a}=h();return a?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"text-center p-5",children:"Loading..."})}):s?t:Object(o.jsx)(n.a,{to:"/login"})},J=e=>{let{children:t}=e;const{hasPremiumAccess:s,loading:a}=h();return a?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"text-center p-5",children:"Loading..."})}):s()?t:Object(o.jsx)(n.a,{to:"/subscription"})},Y=()=>{const{currentUser:e,loading:t}=h();return t?Object(o.jsx)("div",{className:"container mt-4",children:Object(o.jsx)("div",{className:"text-center p-5",children:"Loading..."})}):Object(o.jsx)(n.a,{to:e?"/dashboard":"/"})};var G=()=>Object(o.jsx)(b,{children:Object(o.jsx)(O,{children:Object(o.jsxs)(l.a,{children:[Object(o.jsx)(g,{}),Object(o.jsx)("main",{className:"main-content",children:Object(o.jsxs)(n.d,{children:[Object(o.jsx)(n.b,{path:"/login",element:Object(o.jsx)(v,{})}),Object(o.jsx)(n.b,{path:"/register",element:Object(o.jsx)(f,{})}),Object(o.jsx)(n.b,{path:"/dashboard",element:Object(o.jsx)(M,{children:Object(o.jsx)(N,{})})}),Object(o.jsx)(n.b,{path:"/pillars",element:Object(o.jsx)(M,{children:Object(o.jsx)(k,{})})}),Object(o.jsx)(n.b,{path:"/pillars/:pillarId",element:Object(o.jsx)(M,{children:Object(o.jsx)(_,{})})}),Object(o.jsx)(n.b,{path:"/pillars/:pillarId/techniques",element:Object(o.jsx)(M,{children:Object(o.jsx)(S,{})})}),Object(o.jsx)(n.b,{path:"/challenges",element:Object(o.jsx)(M,{children:Object(o.jsx)(q,{})})}),Object(o.jsx)(n.b,{path:"/challenges/:challengeId",element:Object(o.jsx)(M,{children:Object(o.jsx)(B,{})})}),Object(o.jsx)(n.b,{path:"/subscription",element:Object(o.jsx)(M,{children:Object(o.jsx)(T,{})})}),Object(o.jsx)(n.b,{path:"/rewards",element:Object(o.jsx)(M,{children:Object(o.jsx)(J,{children:Object(o.jsx)(I,{})})})}),Object(o.jsx)(n.b,{path:"/profile",element:Object(o.jsx)(M,{children:Object(o.jsx)(F,{})})}),Object(o.jsx)(n.b,{path:"/",element:Object(o.jsx)(Y,{})})]})})]})})});i.a.createRoot(document.getElementById("root")).render(Object(o.jsx)(c.a.StrictMode,{children:Object(o.jsx)(G,{})}))}},[[56,1,2]]]);
//# sourceMappingURL=main.82ff9bd9.chunk.js.map