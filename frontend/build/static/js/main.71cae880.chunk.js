(this["webpackJsonpconfident-kids-app-frontend"]=this["webpackJsonpconfident-kids-app-frontend"]||[]).push([[0],{11:function(e,t,s){},12:function(e,t,s){},22:function(e,t,s){},23:function(e,t,s){},24:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),i=s(8),l=s.n(i),r=s(3),n=s(5),d=s(0);const o=Object(a.createContext)(),j="https://confident-kids-api.kevin-mcgovern.workers.dev",h=()=>Object(a.useContext)(o);function b(e){let{children:t}=e;const[s,c]=Object(a.useState)(null),[i,l]=Object(a.useState)(null),[r,n]=Object(a.useState)(!0),[h,b]=Object(a.useState)(""),[m,p]=Object(a.useState)(!1);async function u(){try{const e=localStorage.getItem("authToken");if(!e)return c(null),p(!1),n(!1),null;console.log("Fetching user profile with token:",e.substring(0,10)+"...");const t=await fetch(`${j}/api/users/profile`,{method:"GET",headers:{Authorization:`Bearer ${e}`}}),s=await t.json();if(console.log("User profile response:",s),!t.ok){if(401===t.status)return localStorage.removeItem("authToken"),c(null),p(!1),n(!1),null;throw new Error(s.message||"Failed to fetch user profile")}const a=s.user||s;return c(a),p(!0),a}catch(h){return console.error("Error fetching current user:",h),localStorage.removeItem("authToken"),c(null),p(!1),null}}async function O(){try{const e=localStorage.getItem("authToken");if(!e||!s)return l(null),null;console.log("Fetching subscription status");const t=await fetch(`${j}/api/subscriptions/status`,{method:"GET",headers:{Authorization:`Bearer ${e}`}}),a=await t.json();if(console.log("Subscription status response:",a),!t.ok)throw new Error(a.message||"Failed to fetch subscription status");return l(a.subscription),a.subscription}catch(h){return console.error("Error fetching subscription status:",h),l(null),null}}Object(a.useEffect)((()=>{let e=!0;return async function(){console.log("Loading user data on mount");try{await u()&&e&&(console.log("User found, fetching subscription status"),await O())}catch(h){console.error("Error loading user data:",h),e&&(c(null),p(!1))}finally{e&&n(!1)}}(),()=>{e=!1}}),[]);const x={currentUser:s,user:s,userSubscription:i,isAuthenticated:m,loading:r,error:h,register:async function(e,t,s){try{b(""),console.log("Registering with:",{email:e,name:s}),console.log("Using API URL:",j);const a=await fetch(`${j}/api/users/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,name:s})}),i=await a.json();if(console.log("Register response:",i),!a.ok)throw new Error(i.message||"Failed to register");return localStorage.setItem("authToken",i.token),c(i.user),p(!0),i}catch(h){throw console.error("Registration error:",h),b(h.message),h}},login:async function(e,t){try{b(""),console.log("Logging in with:",{email:e}),console.log("Using API URL:",j);const s=await fetch(`${j}/api/users/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await s.json();if(console.log("Login response:",a),!s.ok)throw new Error(a.message||"Failed to login");return localStorage.setItem("authToken",a.token),c(a.user),p(!0),console.log("Auth state after login:",{user:a.user,isAuthenticated:!0}),await O(),a}catch(h){throw console.error("Login error:",h),b(h.message),h}},logout:async function(){try{return b(""),localStorage.removeItem("authToken"),c(null),l(null),p(!1),!0}catch(h){throw b(h.message),h}},updateProfile:async function(e){try{b("");const t=localStorage.getItem("authToken");if(!t)throw new Error("Not authenticated");const s=await fetch(`${j}/api/users/update`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}),a=await s.json();if(!s.ok)throw new Error(a.message||"Failed to update profile");return c((e=>({...e,...a.user}))),a}catch(h){throw b(h.message),h}},fetchCurrentUser:u,fetchSubscriptionStatus:O,hasPremiumAccess:function(){return i&&"active"===i.status}};return console.log("AuthContext state:",{isAuthenticated:m,hasUser:!!s,hasSubscription:!!i,loading:r}),Object(d.jsx)(o.Provider,{value:x,children:t})}s(7);var m=s(4),p=s.p+"static/media/logo.0f63a7c9.png";var u=()=>{const[e,t]=Object(a.useState)(!1),{currentUser:s,logout:c,userSubscription:i}=h(),l=Object(r.o)();Object(a.useEffect)((()=>{t(!1)}),[l]);return Object(d.jsx)("nav",{className:"navbar",children:Object(d.jsxs)("div",{className:"navbar-container",children:[Object(d.jsxs)(n.b,{to:"/",className:"navbar-logo",children:[Object(d.jsx)("img",{src:p,alt:"Confident Kids Logo"}),Object(d.jsx)("span",{children:"Confident Kids"})]}),Object(d.jsx)("button",{className:"navbar-toggle",onClick:()=>{t(!e)},"aria-label":"Toggle navigation",children:e?Object(d.jsx)(m.q,{}):Object(d.jsx)(m.b,{})}),Object(d.jsxs)("ul",{className:"navbar-menu "+(e?"active":""),children:[Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsx)(n.b,{to:"/",className:"navbar-link "+("/"===l.pathname?"active":""),children:"Home"})}),s&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsx)(n.b,{to:"/dashboard",className:"navbar-link "+("/dashboard"===l.pathname?"active":""),children:"Dashboard"})}),Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsx)(n.b,{to:"/pillars",className:"navbar-link "+(l.pathname.includes("/pillars")?"active":""),children:"Pillars"})}),Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsx)(n.b,{to:"/challenges",className:"navbar-link "+("/challenges"===l.pathname?"active":""),children:"Challenges"})}),i&&"active"===i.status&&Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsxs)(n.b,{to:"/rewards",className:"navbar-link "+("/rewards"===l.pathname?"active":""),children:["Rewards",Object(d.jsx)("span",{className:"premium-badge",children:"PRO"})]})}),Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsxs)(n.b,{to:"/profile",className:"navbar-link "+("/profile"===l.pathname?"active":""),children:[Object(d.jsx)(m.s,{})," Profile"]})}),Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsxs)("button",{onClick:async()=>{try{await c()}catch(e){console.error("Failed to log out",e)}},className:"navbar-link",children:[Object(d.jsx)(m.o,{})," Logout"]})})]}),!s&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsx)(n.b,{to:"/about",className:"navbar-link "+("/about"===l.pathname?"active":""),children:"About"})}),Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsx)(n.b,{to:"/login",className:"navbar-link "+("/login"===l.pathname?"active":""),children:"Login"})}),Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsx)(n.b,{to:"/register",className:"navbar-cta",children:"Sign Up"})})]}),s&&"active"===!(null!==i&&void 0!==i&&i.status)&&Object(d.jsx)("li",{className:"navbar-item",children:Object(d.jsxs)(n.b,{to:"/subscription",className:"navbar-cta",children:[Object(d.jsx)(m.i,{})," Upgrade"]})})]})]})})};var O=()=>{const[e,t]=Object(a.useState)(""),[s,c]=Object(a.useState)(""),[i,l]=Object(a.useState)(""),[o,j]=Object(a.useState)(!1),{login:b}=h(),p=Object(r.q)();return Object(d.jsx)("div",{className:"container",children:Object(d.jsx)("div",{className:"row justify-content-center",children:Object(d.jsx)("div",{className:"col-md-6",children:Object(d.jsxs)("div",{className:"card mt-5",children:[Object(d.jsx)("div",{className:"card-header",children:Object(d.jsx)("h2",{className:"text-center",children:"Log In"})}),Object(d.jsxs)("div",{className:"card-body",children:[i&&Object(d.jsx)("div",{className:"alert alert-danger",role:"alert",children:i}),Object(d.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{l(""),j(!0),await b(e,s),p("/dashboard")}catch(i){l(i.message||"Failed to log in")}finally{j(!1)}},children:[Object(d.jsxs)("div",{className:"form-group mb-3",children:[Object(d.jsxs)("label",{htmlFor:"email",children:[Object(d.jsx)(m.j,{className:"me-2"})," Email"]}),Object(d.jsx)("input",{type:"email",id:"email",className:"form-control",value:e,onChange:e=>t(e.target.value),required:!0})]}),Object(d.jsxs)("div",{className:"form-group mb-4",children:[Object(d.jsxs)("label",{htmlFor:"password",children:[Object(d.jsx)(m.k,{className:"me-2"})," Password"]}),Object(d.jsx)("input",{type:"password",id:"password",className:"form-control",value:s,onChange:e=>c(e.target.value),required:!0})]}),Object(d.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:o,children:o?"Logging In...":"Log In"})]}),Object(d.jsx)("div",{className:"text-center mt-3",children:Object(d.jsx)(n.b,{to:"/forgot-password",children:"Forgot Password?"})})]}),Object(d.jsxs)("div",{className:"card-footer text-center",children:["Need an account? ",Object(d.jsx)(n.b,{to:"/register",children:"Sign Up"})]})]})})})})};var x=()=>{const[e,t]=Object(a.useState)(""),[s,c]=Object(a.useState)(""),[i,l]=Object(a.useState)(""),[o,j]=Object(a.useState)(""),[b,p]=Object(a.useState)(""),[u,O]=Object(a.useState)(!1),{register:x}=h(),g=Object(r.q)();return Object(d.jsx)("div",{className:"container",children:Object(d.jsx)("div",{className:"row justify-content-center",children:Object(d.jsx)("div",{className:"col-md-6",children:Object(d.jsxs)("div",{className:"card mt-5",children:[Object(d.jsx)("div",{className:"card-header",children:Object(d.jsx)("h2",{className:"text-center",children:"Create Your Account"})}),Object(d.jsxs)("div",{className:"card-body",children:[b&&Object(d.jsx)("div",{className:"alert alert-danger",role:"alert",children:b}),Object(d.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),i!==o)return p("Passwords do not match");if(i.length<6)return p("Password must be at least 6 characters");try{p(""),O(!0),await x(s,i,e),g("/dashboard")}catch(b){p(b.message||"Failed to create an account")}finally{O(!1)}},children:[Object(d.jsxs)("div",{className:"form-group mb-3",children:[Object(d.jsxs)("label",{htmlFor:"name",children:[Object(d.jsx)(m.s,{className:"me-2"})," Full Name"]}),Object(d.jsx)("input",{type:"text",id:"name",className:"form-control",value:e,onChange:e=>t(e.target.value),required:!0})]}),Object(d.jsxs)("div",{className:"form-group mb-3",children:[Object(d.jsxs)("label",{htmlFor:"email",children:[Object(d.jsx)(m.j,{className:"me-2"})," Email"]}),Object(d.jsx)("input",{type:"email",id:"email",className:"form-control",value:s,onChange:e=>c(e.target.value),required:!0})]}),Object(d.jsxs)("div",{className:"form-group mb-3",children:[Object(d.jsxs)("label",{htmlFor:"password",children:[Object(d.jsx)(m.k,{className:"me-2"})," Password"]}),Object(d.jsx)("input",{type:"password",id:"password",className:"form-control",value:i,onChange:e=>l(e.target.value),required:!0})]}),Object(d.jsxs)("div",{className:"form-group mb-4",children:[Object(d.jsxs)("label",{htmlFor:"confirmPassword",children:[Object(d.jsx)(m.k,{className:"me-2"})," Confirm Password"]}),Object(d.jsx)("input",{type:"password",id:"confirmPassword",className:"form-control",value:o,onChange:e=>j(e.target.value),required:!0})]}),Object(d.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:u,children:u?"Creating Account...":"Sign Up"})]})]}),Object(d.jsxs)("div",{className:"card-footer text-center",children:["Already have an account? ",Object(d.jsx)(n.b,{to:"/login",children:"Log In"})]})]})})})})};var g=()=>{const[e,t]=Object(a.useState)(null),[s,c]=Object(a.useState)(null),[i,l]=Object(a.useState)(!0),[r,o]=Object(a.useState)(""),{currentUser:j,hasPremiumAccess:b}=h(),p=b();Object(a.useEffect)((()=>{console.log("Dashboard: currentUser changed",j)}),[j]),Object(a.useEffect)((()=>{var e;(null===j||void 0===j||null===(e=j.children)||void 0===e?void 0:e.length)>0&&!s&&(console.log("Dashboard: Setting initial child",j.children[0]),c(j.children[0].id))}),[j,s]),Object(a.useEffect)((()=>{let e=!0;return(async()=>{try{l(!0);const a=localStorage.getItem("authToken");if(!a)throw new Error("No authentication token found");const c=s?`https://confident-kids-api.kevin-mcgovern.workers.dev/api/dashboard?childId=${s}`:"https://confident-kids-api.kevin-mcgovern.workers.dev/api/dashboard";console.log("Dashboard: Fetching data from URL:",c);const i=await fetch(c,{method:"GET",headers:{Authorization:`Bearer ${a}`}}),r=await i.json();if(console.log("Dashboard: Received data:",r),!i.ok)throw new Error(r.message||"Failed to fetch dashboard data");e&&t(r)}catch(r){console.error("Error fetching dashboard data:",r),e&&o("Failed to load dashboard data. Please try again later.")}finally{e&&l(!1)}})(),()=>{e=!1}}),[s]);return i?Object(d.jsx)("div",{className:"text-center p-5",children:"Loading dashboard data..."}):r?Object(d.jsx)("div",{className:"alert alert-danger",children:r}):e?j?Object(d.jsxs)("div",{className:"container mt-4",children:[Object(d.jsxs)("div",{className:"dashboard-welcome",children:[Object(d.jsxs)("h1",{children:["Welcome, ",j.name,"!"]}),Object(d.jsx)("p",{children:"Track your child's confidence journey and explore activities designed to build their confidence."})]}),j.children&&j.children.length>0?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"child-selector mb-4",children:[Object(d.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(d.jsx)("select",{id:"childSelect",className:"form-control",value:s,onChange:e=>{c(e.target.value)},children:j.children.map((e=>Object(d.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}),s?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"dashboard-stats",children:[Object(d.jsxs)("div",{className:"stat-card",children:[Object(d.jsx)(m.d,{className:"mb-2",size:24}),Object(d.jsxs)("div",{className:"stat-value",children:[e.overallProgress,"%"]}),Object(d.jsx)("div",{className:"stat-label",children:"Overall Progress"})]}),Object(d.jsxs)("div",{className:"stat-card",children:[Object(d.jsx)(m.c,{className:"mb-2",size:24}),Object(d.jsx)("div",{className:"stat-value",children:e.activitiesCompleted}),Object(d.jsx)("div",{className:"stat-label",children:"Activities Completed"})]}),Object(d.jsxs)("div",{className:"stat-card",children:[Object(d.jsx)(m.r,{className:"mb-2",size:24}),Object(d.jsx)("div",{className:"stat-value",children:p?e.points:"Locked"}),Object(d.jsxs)("div",{className:"stat-label",children:["Reward Points ",!p&&Object(d.jsx)("span",{className:"premium-badge",children:"PRO"})]})]})]}),Object(d.jsxs)("div",{className:"today-challenge",children:[Object(d.jsx)("h2",{children:"Today's Challenge"}),Object(d.jsxs)("div",{className:"challenge-container",children:[Object(d.jsx)("h3",{className:"challenge-title",children:e.todayChallenge.title}),Object(d.jsx)("p",{className:"challenge-description",children:e.todayChallenge.description}),Object(d.jsx)(n.b,{to:`/challenges/${e.todayChallenge.id}`,className:"btn btn-primary mt-3",children:"Start Challenge"})]})]}),Object(d.jsx)("h2",{className:"mt-5 mb-3",children:"Confidence Pillars"}),Object(d.jsx)("div",{className:"grid-3",children:e.pillars.map((e=>Object(d.jsxs)("div",{className:`pillar-card pillar-card-${e.id}`,children:[Object(d.jsx)("div",{className:"pillar-card-header",children:Object(d.jsx)("h3",{children:e.name})}),Object(d.jsxs)("div",{className:"pillar-card-body",children:[Object(d.jsx)("p",{children:e.shortDescription}),Object(d.jsxs)("div",{className:"progress-label",children:[Object(d.jsx)("span",{children:"Progress"}),Object(d.jsxs)("span",{children:[e.progress,"%"]})]}),Object(d.jsx)("div",{className:"progress-container",children:Object(d.jsx)("div",{className:`progress-bar progress-bar-${e.id}`,style:{width:`${e.progress}%`}})})]}),Object(d.jsxs)("div",{className:"pillar-card-footer",children:[Object(d.jsxs)("span",{children:[e.activitiesCompleted,"/",e.totalActivities," Activities"]}),Object(d.jsx)(n.b,{to:`/pillars/${e.id}`,className:"btn btn-sm btn-outline",children:"Explore"})]})]},e.id)))})]}):Object(d.jsxs)("div",{className:"alert alert-info mt-4",children:[Object(d.jsx)("h4",{children:"Select a Child"}),Object(d.jsx)("p",{children:"Please select a child from the dropdown above to view their dashboard."})]})]}):Object(d.jsxs)("div",{className:"alert alert-info mt-4",children:[Object(d.jsx)("h4",{children:"Let's Get Started!"}),Object(d.jsx)("p",{children:"Add your child's profile to begin their confidence journey."}),Object(d.jsx)(n.b,{to:"/profile",className:"btn btn-primary mt-2",children:"Add Child Profile"})]}),!p&&Object(d.jsxs)("div",{className:"upgrade-prompt standard mt-5",children:[Object(d.jsxs)("h3",{children:[Object(d.jsx)(m.i,{className:"me-2"})," Unlock Premium Features"]}),Object(d.jsx)("p",{children:"Subscribe to our premium plan to access all activities, detailed progress tracking, and rewards for your child."}),Object(d.jsx)(n.b,{to:"/subscription",className:"upgrade-button",children:"Upgrade Now"})]})]}):Object(d.jsxs)("div",{className:"container mt-4",children:[Object(d.jsxs)("div",{className:"dashboard-welcome",children:[Object(d.jsx)("h1",{children:"Welcome!"}),Object(d.jsx)("p",{children:"Track your child's confidence journey and explore activities designed to build their confidence."})]}),Object(d.jsxs)("div",{className:"alert alert-info mt-4",children:[Object(d.jsx)("h4",{children:"Let's Get Started!"}),Object(d.jsx)("p",{children:"Add your child's profile to begin their confidence journey."}),Object(d.jsx)(n.b,{to:"/profile",className:"btn btn-primary mt-2",children:"Add Child Profile"})]})]}):Object(d.jsx)("div",{className:"text-center p-5",children:"No dashboard data available."})};const v="https://confident-kids-api.kevin-mcgovern.workers.dev";var f=e=>{let{childId:t,pillarId:s}=e;const[c,i]=Object(a.useState)(null),[l,r]=Object(a.useState)(!0),[n,o]=Object(a.useState)(""),{currentUser:j,hasPremiumAccess:b}=h();b();Object(a.useEffect)((()=>{t&&(async()=>{try{r(!0);const e=localStorage.getItem("authToken");if(!e)throw new Error("No authentication token found");const a=await fetch(`${v}/api/progress/stats/child/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to fetch progress statistics")}const c=await a.json();if(s){const a=await fetch(`${v}/api/progress/pillar/${s}/child/${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to fetch pillar progress")}const l=await a.json();i({...c,pillarProgress:l})}else i(c)}catch(n){console.error("Error fetching progress:",n),o(n.message||"Failed to load progress data")}finally{r(!1)}})()}),[t,s]);return l?Object(d.jsx)("div",{className:"progress-section",children:Object(d.jsx)("div",{className:"progress-loading",children:"Loading progress..."})}):n?Object(d.jsx)("div",{className:"progress-section",children:Object(d.jsx)("div",{className:"progress-error alert alert-danger",children:n})}):c?Object(d.jsxs)("div",{className:"progress-tracking",children:[Object(d.jsxs)("div",{className:"progress-summary",children:[Object(d.jsxs)("div",{className:"progress-stat",children:[Object(d.jsx)(m.r,{className:"icon"}),Object(d.jsxs)("div",{className:"stat-content",children:[Object(d.jsx)("span",{className:"stat-value",children:c.totalCompleted||0}),Object(d.jsx)("span",{className:"stat-label",children:"Challenges Completed"})]})]}),Object(d.jsxs)("div",{className:"progress-stat",children:[Object(d.jsx)(m.p,{className:"icon"}),Object(d.jsxs)("div",{className:"stat-content",children:[Object(d.jsx)("span",{className:"stat-value",children:(c.averageRating||0).toFixed(1)}),Object(d.jsx)("span",{className:"stat-label",children:"Average Rating"})]})]})]}),s&&c.pillarProgress&&c.pillarProgress.length>0&&Object(d.jsxs)("div",{className:"pillar-progress",children:[Object(d.jsx)("h3",{children:"Recent Challenges"}),Object(d.jsx)("div",{className:"recent-challenges",children:c.pillarProgress.slice(0,3).map((e=>Object(d.jsxs)("div",{className:"recent-challenge",children:[Object(d.jsxs)("div",{className:"challenge-info",children:[Object(d.jsx)("h4",{children:e.activity.title}),Object(d.jsxs)("div",{className:"challenge-meta",children:[Object(d.jsxs)("span",{className:"rating",children:[Object(d.jsx)(m.p,{})," ",e.rating||0]}),Object(d.jsx)("span",{className:"date",children:new Date(e.completedAt).toLocaleDateString()})]})]}),e.notes&&Object(d.jsx)("p",{className:"challenge-notes",children:e.notes})]},e.id)))})]}),c.progressByPillar&&c.progressByPillar.length>0&&Object(d.jsxs)("div",{className:"progress-by-pillar",children:[Object(d.jsx)("h3",{children:"Progress by Pillar"}),Object(d.jsx)("div",{className:"pillars-grid",children:c.progressByPillar.map((e=>{var t,s;return Object(d.jsxs)("div",{className:"pillar-progress-card",children:[Object(d.jsxs)("div",{className:"pillar-header",children:[Object(d.jsx)("h4",{children:e.pillar.name}),Object(d.jsx)("span",{className:"pillar-icon",children:e.pillar.icon})]}),Object(d.jsxs)("div",{className:"pillar-stats",children:[Object(d.jsxs)("div",{className:"stat",children:[Object(d.jsx)(m.d,{className:"icon"}),Object(d.jsxs)("span",{children:[(null===(t=e._count)||void 0===t?void 0:t.id)||0," completed"]})]}),Object(d.jsxs)("div",{className:"stat",children:[Object(d.jsx)(m.p,{className:"icon"}),Object(d.jsxs)("span",{children:[((null===(s=e._avg)||void 0===s?void 0:s.rating)||0).toFixed(1)," avg rating"]})]})]})]},e.pillarId)}))})]})]}):null};var N=e=>{let{challenge:t,childId:s,pillarId:c,onComplete:i}=e;const[l,r]=Object(a.useState)(!1),[n,o]=Object(a.useState)(0),[j,h]=Object(a.useState)("");return Object(d.jsxs)("div",{className:"challenge-card",children:[Object(d.jsxs)("div",{className:"challenge-header",onClick:()=>r(!l),children:[Object(d.jsx)("h3",{children:t.title}),Object(d.jsxs)("div",{className:"challenge-meta",children:[Object(d.jsxs)("span",{className:"difficulty",children:[Object(d.jsx)(m.p,{className:"easy"===t.difficulty?"text-success":"medium"===t.difficulty?"text-warning":"text-danger"}),t.difficulty]}),Object(d.jsxs)("span",{className:"duration",children:[Object(d.jsx)(m.g,{})," ",t.durationMinutes," min"]}),Object(d.jsxs)("span",{className:"age-range",children:[Object(d.jsx)(m.t,{})," ",t.minAge,"-",t.maxAge," years"]})]})]}),l&&Object(d.jsxs)("div",{className:"challenge-content",children:[Object(d.jsx)("p",{className:"description",children:t.description}),Object(d.jsxs)("div",{className:"instructions",children:[Object(d.jsx)("h4",{children:"Instructions for Parents:"}),Object(d.jsx)("p",{children:t.instructions})]}),t.materials&&Object(d.jsxs)("div",{className:"materials",children:[Object(d.jsx)("h4",{children:"Materials Needed:"}),Object(d.jsx)("p",{children:t.materials})]}),Object(d.jsxs)("div",{className:"completion-form",children:[Object(d.jsx)("h4",{children:"Complete Challenge"}),Object(d.jsxs)("div",{className:"rating-input",children:[Object(d.jsx)("label",{children:"Rating (1-5):"}),Object(d.jsx)("div",{className:"stars",children:[1,2,3,4,5].map((e=>Object(d.jsx)(m.p,{className:"star "+(e<=n?"active":""),onClick:()=>o(e)},e)))})]}),Object(d.jsxs)("div",{className:"notes-input",children:[Object(d.jsx)("label",{children:"Notes:"}),Object(d.jsx)("textarea",{value:j,onChange:e=>h(e.target.value),placeholder:"Add any notes about how the challenge went..."})]}),Object(d.jsx)("button",{className:"btn btn-primary",onClick:async()=>{try{if(!(await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/progress",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({childId:s,pillarId:c,activityId:t.id,rating:n,notes:j})})).ok)throw new Error("Failed to mark challenge as complete");i&&i(t.id),r(!1)}catch(e){console.error("Error completing challenge:",e)}},disabled:0===n,children:"Mark as Complete"})]})]})]})};s(11);const y="https://confident-kids-api.kevin-mcgovern.workers.dev";var w=()=>{const{pillarId:e}=Object(r.s)(),[t,s]=Object(a.useState)(null),[c,i]=Object(a.useState)([]),[l,o]=Object(a.useState)(!0),[j,b]=Object(a.useState)(""),[p,u]=Object(a.useState)(null),{user:O,hasPremiumAccess:x}=h(),g=x();Object(a.useEffect)((()=>{(async()=>{if(O)try{o(!0),b("");const t=localStorage.getItem("authToken");if(!t)throw new Error("No authentication token found");const a=await fetch(`${y}/api/pillars/${e}`,{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to fetch pillar data")}const c=await a.json();s(c),O.children&&O.children.length>0&&!p&&u(O.children[0].id)}catch(j){console.error("Error fetching data:",j),b(j.message||"Failed to load data. Please try again later.")}finally{o(!1)}else o(!1)})()}),[e,O,p]),Object(a.useEffect)((()=>{(async()=>{if(p&&O)try{o(!0),b("");const t=localStorage.getItem("authToken");if(!t)throw new Error("No authentication token found");const s=await fetch(`${y}/api/pillars/${e}/challenges?childId=${p}`,{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(!s.ok){const e=await s.json();throw new Error(e.message||"Failed to fetch challenges")}const a=await s.json();i(a.challenges||[])}catch(j){console.error("Error fetching challenges:",j),b(j.message||"Failed to load challenges. Please try again later.")}finally{o(!1)}})()}),[e,p,O]);const v=e=>{i(c.map((t=>t.id===e?{...t,completed:!0}:t)))};if(!O)return Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"alert alert-warning",children:"Please log in to view pillar details."})});if(l)return Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"text-center p-5",children:"Loading pillar data..."})});if(j)return Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"alert alert-danger",children:j})});if(!t)return Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"text-center p-5",children:"Pillar not found."})});const w=g?c:c.slice(0,1);return Object(d.jsxs)("div",{className:"container mt-4",children:[Object(d.jsxs)("div",{className:`pillar-card pillar-card-${t.id} mb-4`,children:[Object(d.jsxs)("div",{className:"pillar-card-header",children:[Object(d.jsx)("h1",{children:t.name}),t.icon&&Object(d.jsx)("span",{className:"pillar-icon",children:t.icon})]}),Object(d.jsxs)("div",{className:"pillar-card-body",children:[Object(d.jsx)("p",{children:t.shortDescription}),O.children&&O.children.length>0?Object(d.jsxs)("div",{className:"child-selector mb-4",children:[Object(d.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(d.jsxs)("select",{id:"childSelect",className:"form-control",value:p||"",onChange:e=>{u(e.target.value)},children:[Object(d.jsx)("option",{value:"",children:"Select a child"}),O.children.map((e=>Object(d.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))]})]}):Object(d.jsx)("div",{className:"alert alert-info",children:"Please add a child to your profile to view challenges."}),p&&Object(d.jsx)(f,{childId:p,pillarId:e})]})]}),p?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h2",{className:"mb-3",children:"Confidence Challenges"}),Object(d.jsxs)("div",{className:"challenges-grid",children:[w.map((t=>Object(d.jsx)(N,{challenge:t,childId:p,pillarId:e,onComplete:v},t.id))),!g&&c.length>1&&Object(d.jsxs)("div",{className:"premium-feature-container",children:[Object(d.jsx)("div",{className:"premium-feature-preview",children:Object(d.jsx)(N,{challenge:{id:"preview",title:"Premium Challenge",description:"This premium challenge helps your child develop confidence through guided exercises...",difficulty:"medium",durationMinutes:15,minAge:5,maxAge:12},childId:p,pillarId:e})}),Object(d.jsxs)("div",{className:"premium-feature-overlay",children:[Object(d.jsx)("div",{className:"lock-icon",children:Object(d.jsx)(m.k,{})}),Object(d.jsx)("h4",{children:"Premium Challenges"}),Object(d.jsxs)("p",{children:["Unlock ",c.length-1," more challenges for this pillar with a premium subscription"]}),Object(d.jsxs)(n.b,{to:"/subscription",className:"btn btn-secondary mt-2",children:[Object(d.jsx)(m.i,{className:"me-2"})," Upgrade Now"]})]})]})]}),!g&&Object(d.jsxs)("div",{className:"upgrade-prompt standard mt-4",children:[Object(d.jsxs)("h3",{children:[Object(d.jsx)(m.i,{className:"me-2"})," Unlock All Challenges"]}),Object(d.jsx)("p",{children:"Subscribe to our premium plan to access all challenges, detailed progress tracking, and rewards for your child."}),Object(d.jsx)(n.b,{to:"/subscription",className:"upgrade-button",children:"Upgrade Now"})]})]}):Object(d.jsx)("div",{className:"alert alert-info",children:"Please select a child to view challenges."})]})};s(22);const k="https://confident-kids-api.kevin-mcgovern.workers.dev";var S=()=>{const{user:e}=h(),[t,s]=Object(a.useState)(null),[c,i]=Object(a.useState)([]),[l,r]=Object(a.useState)([]),[o,j]=Object(a.useState)([]),[b,p]=Object(a.useState)([]),[u,O]=Object(a.useState)(!0),[x,g]=Object(a.useState)("");Object(a.useEffect)((()=>{e&&e.children&&e.children.length>0&&!t&&s(e.children[0].id)}),[e]),Object(a.useEffect)((()=>{(async()=>{if(e&&t)try{O(!0);const e=localStorage.getItem("authToken"),s=await fetch(`${k}/api/pillars?childId=${t}`,{headers:{Authorization:`Bearer ${e}`}}),a=await fetch(`${k}/api/content`,{headers:{Authorization:`Bearer ${e}`}}),c=await fetch(`${k}/api/challenges?childId=${t}`,{headers:{Authorization:`Bearer ${e}`}}),l=await fetch(`${k}/api/achievements?childId=${t}`,{headers:{Authorization:`Bearer ${e}`}}),[n,d,o,h]=await Promise.all([s.json(),a.json(),c.json(),l.json()]);i(n),r(d),j(o),p(h)}catch(x){console.error("Error fetching data:",x),g("Failed to load data. Please try again later.")}finally{O(!1)}})()}),[e,t]);return e?u?Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"text-center p-5",children:"Loading pillars..."})}):x?Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"alert alert-danger",children:x})}):Object(d.jsxs)("div",{className:"container mt-4",children:[e.children&&e.children.length>0&&Object(d.jsxs)("div",{className:"child-selector mb-4",children:[Object(d.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(d.jsx)("select",{id:"childSelect",className:"form-control",value:(null===t||void 0===t?void 0:t.id)||"",onChange:t=>{const a=t.target.value,c=e.children.find((e=>e.id===a));s(c)},children:e.children.map((e=>Object(d.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}),Object(d.jsxs)("div",{className:"pillars-overview",children:[Object(d.jsxs)("div",{className:"daily-challenge-section",children:[Object(d.jsx)("h2",{children:"Today's Challenge"}),o.length>0&&Object(d.jsxs)("div",{className:"daily-challenge",children:[Object(d.jsx)("h3",{children:o[0].title}),Object(d.jsx)("p",{children:o[0].description}),Object(d.jsx)(n.b,{to:`/challenges/${o[0].id}`,className:"btn btn-primary",children:"Start Challenge"})]})]}),Object(d.jsx)("div",{className:"pillars-grid",children:c.map((e=>{const t=l.filter((t=>t.pillar_id===e.id)),s=o.filter((t=>t.pillar_id===e.id)),a=b.filter((t=>t.description.includes(e.name)));return Object(d.jsxs)("div",{className:"pillar-card",children:[Object(d.jsxs)("div",{className:"pillar-header",children:[Object(d.jsx)("h3",{children:e.name}),Object(d.jsx)("p",{className:"pillar-description",children:e.short_description})]}),Object(d.jsxs)("div",{className:"pillar-stats",children:[Object(d.jsxs)("div",{className:"stat",children:[Object(d.jsx)(m.p,{className:"icon"}),Object(d.jsxs)("span",{children:[t.length," Techniques"]})]}),Object(d.jsxs)("div",{className:"stat",children:[Object(d.jsx)(m.c,{className:"icon"}),Object(d.jsxs)("span",{children:[s.length," Challenges"]})]}),Object(d.jsxs)("div",{className:"stat",children:[Object(d.jsx)(m.r,{className:"icon"}),Object(d.jsxs)("span",{children:[a.length," Achievements"]})]})]}),Object(d.jsxs)("div",{className:"pillar-progress",children:[Object(d.jsxs)("div",{className:"progress-label",children:[Object(d.jsx)("span",{children:"Progress"}),Object(d.jsxs)("span",{children:[e.progress||0,"%"]})]}),Object(d.jsx)("div",{className:"progress-container",children:Object(d.jsx)("div",{className:"progress-bar",style:{width:`${e.progress||0}%`}})})]}),Object(d.jsxs)("div",{className:"pillar-actions",children:[Object(d.jsx)(n.b,{to:`/pillars/${e.id}`,className:"btn btn-primary",children:"Explore Pillar"}),Object(d.jsx)(n.b,{to:`/pillars/${e.id}/techniques`,className:"btn btn-secondary",children:"View Techniques"})]})]},e.id)}))}),Object(d.jsxs)("div",{className:"achievements-section",children:[Object(d.jsx)("h2",{children:"Available Achievements"}),Object(d.jsx)("div",{className:"achievements-grid",children:b.map((e=>Object(d.jsxs)("div",{className:"achievement-card",children:[Object(d.jsxs)("div",{className:"achievement-header",children:[Object(d.jsx)("h3",{children:e.name}),Object(d.jsxs)("span",{className:"points",children:[e.points_value," points"]})]}),Object(d.jsx)("p",{children:e.description}),e.creates_certificate&&Object(d.jsx)("span",{className:"certificate-badge",children:"Certificate Available"})]},e.id)))})]})]})]}):Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"alert alert-warning",children:"Please log in to view pillars."})})},C=s(13),P=s(6);const E=Object(C.a)("pk_test_51R55ZbPEQoD1awJQndiLLj3BtKtvHxlcNTHTKEtS8kmXoUJugqf4P9r11ugn4A5UJnywb57E2T7776qPTJFkfKQ2000cVyNrVv"),A=[{id:"monthly",name:"Monthly",price:9.99,interval:"month",description:"Perfect for trying out all premium features",features:["Full access to all 5 pillars","Unlimited activities and challenges","Progress tracking for multiple children","Printable certificates","Rewards marketplace","Social sharing capabilities"]},{id:"yearly",name:"Yearly",price:89.99,regularPrice:119.88,interval:"year",description:"Our most popular plan",features:["Full access to all 5 pillars","Unlimited activities and challenges","Progress tracking for multiple children","Printable certificates","Rewards marketplace","Social sharing capabilities","Priority support","Early access to new features"],bestValue:!0},{id:"lifetime",name:"Lifetime",price:249.99,interval:"once",description:"Pay once, use forever",features:["Full access to all 5 pillars","Unlimited activities and challenges","Progress tracking for multiple children","Printable certificates","Rewards marketplace","Social sharing capabilities","Priority support","Early access to new features","All future updates included"]}],T=e=>{let{selectedPlan:t,onSuccess:s,onError:c}=e;const i=Object(P.useStripe)(),l=Object(P.useElements)(),{currentUser:r}=h(),[n,o]=Object(a.useState)(!1),[j,b]=Object(a.useState)(null);return Object(d.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i&&l){o(!0),b(null);try{const e=l.getElement(P.CardElement),{error:a,paymentMethod:c}=await i.createPaymentMethod({type:"card",card:e});if(a)throw new Error(a.message);const n=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/subscriptions/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({paymentMethodId:c.id,planId:t.id,customerId:r.id,email:r.email})}),d=await n.json();if(!n.ok)throw new Error(d.message||"Failed to process subscription");if("success"===d.status)s(d);else{if("requires_action"!==d.status)throw new Error(d.message||"Subscription failed");{const{error:e,paymentIntent:t}=await i.confirmCardPayment(d.clientSecret);if(e)throw new Error(e.message);if("succeeded"!==t.status)throw new Error("Payment failed");s(d)}}}catch(j){console.error("Subscription error:",j),b(j.message),c(j.message)}finally{o(!1)}}},children:[Object(d.jsx)("div",{className:"card-element-container",children:Object(d.jsx)(P.CardElement,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}})}),j&&Object(d.jsx)("div",{className:"alert alert-danger mb-3",children:j}),Object(d.jsx)("button",{type:"submit",className:"subscribe-button",disabled:!i||n,children:n?"Processing...":`Subscribe for $${t.price}/${"once"===t.interval?"":t.interval}`})]})};var $=()=>{const[e,t]=Object(a.useState)(A[1]),[s,c]=Object(a.useState)(!1),[i,l]=Object(a.useState)(null),{currentUser:n,userSubscription:o,fetchSubscriptionStatus:j}=h(),b=Object(r.q)();Object(a.useEffect)((()=>{o&&"active"===o.status&&b("/dashboard")}),[o,b]);return s?Object(d.jsx)("div",{className:"subscription-page",children:Object(d.jsxs)("div",{className:"success-message",children:[Object(d.jsxs)("h2",{children:[Object(d.jsx)(m.e,{className:"me-2"})," Subscription Successful!"]}),Object(d.jsx)("p",{children:"Thank you for subscribing to Confident Kids Premium. You now have access to all premium features."}),Object(d.jsx)("p",{children:"You will be redirected to your dashboard shortly..."})]})}):Object(d.jsxs)("div",{className:"subscription-page",children:[Object(d.jsxs)("div",{className:"feature-highlight",children:[Object(d.jsxs)("h1",{children:[Object(d.jsx)(m.i,{className:"me-2"})," Upgrade to Confident Kids Premium"]}),Object(d.jsx)("p",{children:"Unlock the full potential of your child's confidence journey with our premium features."})]}),Object(d.jsxs)("div",{className:"plan-selection",children:[Object(d.jsx)("h2",{children:"Choose Your Plan"}),Object(d.jsx)("div",{className:"plan-options",children:A.map((s=>Object(d.jsxs)("div",{className:"plan-card "+(e.id===s.id?"selected":""),onClick:()=>(e=>{t(e)})(s),children:[s.bestValue&&Object(d.jsx)("div",{className:"best-value",children:"Best Value"}),Object(d.jsx)("h3",{children:s.name}),Object(d.jsxs)("div",{className:"price",children:["$",s.price," ",Object(d.jsxs)("span",{children:["/","once"===s.interval?"":s.interval]})]}),s.regularPrice&&Object(d.jsxs)("div",{className:"savings",children:["Save $",(s.regularPrice-s.price).toFixed(2)," per year"]}),Object(d.jsx)("p",{children:s.description}),Object(d.jsx)("ul",{className:"features",children:s.features.map(((e,t)=>Object(d.jsx)("li",{children:e},t)))}),Object(d.jsx)("button",{className:`btn ${e.id===s.id?"btn-primary":"btn-outline"} w-100`,children:e.id===s.id?"Selected":"Select"})]},s.id)))})]}),Object(d.jsxs)("div",{className:"payment-section",children:[Object(d.jsx)("h2",{children:"Payment Information"}),Object(d.jsx)(P.Elements,{stripe:E,children:Object(d.jsx)(T,{selectedPlan:e,onSuccess:async e=>{c(!0),await j(),setTimeout((()=>{b("/dashboard")}),3e3)},onError:e=>{l(e)}})}),i&&Object(d.jsx)("div",{className:"alert alert-danger mt-3",children:i}),Object(d.jsxs)("div",{className:"guarantee",children:[Object(d.jsxs)("p",{children:[Object(d.jsx)(m.m,{})," 30-day money-back guarantee ",Object(d.jsx)(m.m,{})]}),Object(d.jsx)("p",{children:"If you're not satisfied with our premium features, we'll refund your payment within the first 30 days."})]})]})]})};var I=()=>{const[e,t]=Object(a.useState)("achievements"),[s,c]=Object(a.useState)([]),[i,l]=Object(a.useState)([]),[r,n]=Object(a.useState)([]),[o,j]=Object(a.useState)(0),[b,p]=Object(a.useState)(!0),[u,O]=Object(a.useState)(""),{currentUser:x,hasPremiumAccess:g}=h();Object(a.useEffect)((()=>{g()?(async()=>{try{p(!0);const e=localStorage.getItem("authToken"),t=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/rewards",{method:"GET",headers:{Authorization:`Bearer ${e}`}}),s=await t.json();if(!t.ok)throw new Error(s.message||"Failed to fetch rewards data");c(s.achievements),l(s.certificates),n(s.marketplace),j(s.points)}catch(u){console.error("Error fetching rewards data:",u),O("Failed to load rewards data. Please try again later.")}finally{p(!1)}})():p(!1)}),[g]);return g()?b?Object(d.jsx)("div",{className:"text-center p-5",children:"Loading rewards data..."}):u?Object(d.jsx)("div",{className:"alert alert-danger",children:u}):Object(d.jsxs)("div",{className:"rewards-container",children:[Object(d.jsx)("h1",{className:"mb-4",children:"Rewards & Achievements"}),Object(d.jsxs)("div",{className:"points-display",children:[Object(d.jsx)("span",{className:"points-icon",children:Object(d.jsx)(m.p,{})}),Object(d.jsxs)("span",{className:"points-value",children:[o," Points"]})]}),Object(d.jsxs)("div",{className:"rewards-tabs",children:[Object(d.jsx)("button",{className:"achievements"===e?"active":"",onClick:()=>t("achievements"),children:"Achievements"}),Object(d.jsx)("button",{className:"certificates"===e?"active":"",onClick:()=>t("certificates"),children:"Certificates"}),Object(d.jsx)("button",{className:"marketplace"===e?"active":"",onClick:()=>t("marketplace"),children:"Rewards Marketplace"})]}),Object(d.jsxs)("div",{className:"rewards-content",children:["achievements"===e&&Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{className:"mb-3",children:"Your Child's Achievements"}),Object(d.jsx)("div",{className:"achievement-grid",children:s.map((e=>Object(d.jsxs)("div",{className:"achievement-item "+(e.unlocked?"":"achievement-locked"),children:[Object(d.jsx)("div",{className:"achievement-icon",children:e.icon}),Object(d.jsx)("h4",{children:e.name}),Object(d.jsx)("p",{children:e.description}),e.unlocked?Object(d.jsx)("div",{className:"text-success",children:"Unlocked!"}):Object(d.jsxs)("div",{className:"text-muted",children:[e.progress,"% Complete"]})]},e.id)))})]}),"certificates"===e&&Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{className:"mb-3",children:"Printable Certificates"}),0===i.length?Object(d.jsx)("p",{children:"No certificates earned yet. Complete activities to earn certificates!"}):i.map((e=>{var t,s;return Object(d.jsxs)("div",{className:"mb-4",children:[Object(d.jsx)("h4",{children:e.title}),Object(d.jsx)("div",{className:"certificate-preview",children:Object(d.jsxs)("div",{className:"certificate-content",children:[Object(d.jsx)("h2",{children:e.title}),Object(d.jsxs)("h3",{children:["Awarded to: ",(null===(t=x.children)||void 0===t||null===(s=t.find((t=>t.id===e.childId)))||void 0===s?void 0:s.name)||"Your Child"]}),Object(d.jsx)("p",{children:e.description}),Object(d.jsxs)("p",{children:["Date: ",new Date(e.date).toLocaleDateString()]})]})}),Object(d.jsxs)("div",{className:"certificate-actions",children:[Object(d.jsxs)("button",{className:"btn btn-outline",onClick:()=>{return t=e.id,void console.log(`Sharing certificate ${t}`);var t},children:[Object(d.jsx)(m.n,{className:"me-2"})," Share"]}),Object(d.jsxs)("button",{className:"btn btn-primary print-button",onClick:()=>{return t=e.id,console.log(`Printing certificate ${t}`),void window.print();var t},children:[Object(d.jsx)(m.l,{className:"me-2"})," Print"]})]})]},e.id)}))]}),"marketplace"===e&&Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{className:"mb-3",children:"Rewards Marketplace"}),Object(d.jsx)("p",{children:"Use your points to redeem these special rewards for your child:"}),Object(d.jsx)("div",{className:"marketplace-grid",children:r.map((e=>Object(d.jsxs)("div",{className:"reward-item",children:[Object(d.jsx)("img",{src:e.image,alt:e.name,className:"reward-image"}),Object(d.jsxs)("div",{className:"reward-content",children:[Object(d.jsxs)("div",{className:"reward-points",children:[e.points," Points"]}),Object(d.jsx)("h4",{children:e.name}),Object(d.jsx)("p",{children:e.description}),Object(d.jsx)("button",{className:"btn btn-primary w-100 mt-2",disabled:o<e.points||e.redeemed,onClick:()=>(async e=>{try{const t=localStorage.getItem("authToken"),s=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/rewards/redeem",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({rewardId:e})}),a=await s.json();if(!s.ok)throw new Error(a.message||"Failed to redeem reward");j(a.updatedPoints),n((t=>t.map((t=>t.id===e?{...t,redeemed:!0}:t)))),alert("Reward redeemed successfully!")}catch(u){console.error("Error redeeming reward:",u),alert(`Failed to redeem reward: ${u.message}`)}})(e.id),children:e.redeemed?"Redeemed":"Redeem Reward"})]})]},e.id)))})]})]})]}):Object(d.jsx)("div",{className:"container mt-5",children:Object(d.jsxs)("div",{className:"upgrade-prompt standard",children:[Object(d.jsxs)("h2",{children:[Object(d.jsx)(m.r,{className:"me-2"})," Unlock the Rewards System"]}),Object(d.jsx)("p",{children:"The Rewards System is a premium feature that allows your child to earn achievements, collect certificates, and redeem points for special rewards."}),Object(d.jsx)("p",{children:"Subscribe to our premium plan to motivate your child with tangible rewards for their confidence journey."}),Object(d.jsx)("a",{href:"/subscription",className:"upgrade-button",children:"Upgrade Now"})]})})};s(23);var F=()=>{const[e,t]=Object(a.useState)(null),[s,c]=Object(a.useState)(!0),[i,l]=Object(a.useState)(null),[r,n]=Object(a.useState)("profile");Object(a.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/user",{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Failed to fetch profile");const a=await s.json();t(a)}catch(e){l(e.message)}finally{c(!1)}})()}),[]);return s?Object(d.jsx)("div",{className:"loading",children:"Loading profile..."}):i?Object(d.jsx)("div",{className:"error",children:i}):e?Object(d.jsxs)("div",{className:"profile-container",children:[Object(d.jsxs)("div",{className:"profile-sidebar",children:[Object(d.jsxs)("div",{className:"profile-header",children:[Object(d.jsx)("div",{className:"profile-avatar",children:Object(d.jsx)(m.s,{})}),Object(d.jsx)("h2",{children:e.name}),Object(d.jsx)("p",{children:e.email})]}),Object(d.jsxs)("nav",{className:"profile-nav",children:[Object(d.jsxs)("button",{className:"nav-item "+("profile"===r?"active":""),onClick:()=>n("profile"),children:[Object(d.jsx)(m.s,{})," Profile"]}),Object(d.jsxs)("button",{className:"nav-item "+("settings"===r?"active":""),onClick:()=>n("settings"),children:[Object(d.jsx)(m.h,{})," Settings"]}),Object(d.jsxs)("button",{className:"nav-item "+("security"===r?"active":""),onClick:()=>n("security"),children:[Object(d.jsx)(m.k,{})," Security"]})]})]}),Object(d.jsxs)("div",{className:"profile-content",children:["profile"===r&&Object(d.jsxs)("div",{className:"profile-section",children:[Object(d.jsx)("h3",{children:"Profile Information"}),Object(d.jsxs)("form",{onSubmit:async s=>{s.preventDefault();try{const s=localStorage.getItem("token"),a=await fetch("https://confident-kids-api.kevin-mcgovern.workers.dev/api/user",{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw new Error("Failed to update profile");const c=await a.json();t(c)}catch(a){l(a.message)}},children:[Object(d.jsxs)("div",{className:"form-group",children:[Object(d.jsx)("label",{children:"Name"}),Object(d.jsx)("input",{type:"text",value:e.name,onChange:s=>t({...e,name:s.target.value})})]}),Object(d.jsxs)("div",{className:"form-group",children:[Object(d.jsx)("label",{children:"Email"}),Object(d.jsx)("input",{type:"email",value:e.email,onChange:s=>t({...e,email:s.target.value})})]}),Object(d.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"})]})]}),"settings"===r&&Object(d.jsxs)("div",{className:"settings-section",children:[Object(d.jsx)("h3",{children:"Account Settings"}),Object(d.jsxs)("div",{className:"settings-grid",children:[Object(d.jsxs)("div",{className:"setting-card",children:[Object(d.jsx)("h4",{children:"Language"}),Object(d.jsxs)("select",{value:e.language,onChange:s=>t({...e,language:s.target.value}),children:[Object(d.jsx)("option",{value:"en",children:"English"}),Object(d.jsx)("option",{value:"es",children:"Spanish"}),Object(d.jsx)("option",{value:"fr",children:"French"})]})]}),Object(d.jsxs)("div",{className:"setting-card",children:[Object(d.jsx)("h4",{children:"Theme"}),Object(d.jsxs)("select",{value:e.theme,onChange:s=>t({...e,theme:s.target.value}),children:[Object(d.jsx)("option",{value:"light",children:"Light"}),Object(d.jsx)("option",{value:"dark",children:"Dark"}),Object(d.jsx)("option",{value:"system",children:"System"})]})]})]})]}),"security"===r&&Object(d.jsxs)("div",{className:"security-section",children:[Object(d.jsx)("h3",{children:"Security Settings"}),Object(d.jsxs)("div",{className:"security-options",children:[Object(d.jsx)("button",{className:"btn btn-secondary",children:"Change Password"}),Object(d.jsx)("button",{className:"btn btn-secondary",children:"Enable Two-Factor Authentication"})]})]})]})]}):Object(d.jsx)("div",{className:"no-profile",children:"No profile data available"})};s(12);var U=()=>{const{user:e}=h(),[t,s]=Object(a.useState)(null),[c,i]=Object(a.useState)("daily"),[l,r]=Object(a.useState)({title:"Ask, Don't Tell Challenge",description:"When your child asks for help today, respond with a question that helps them solve the problem themselves.",completed:!1}),[n,o]=Object(a.useState)([{day:1,title:"Ask, Don't Tell Challenge",description:"When your child asks for help today, respond with a question that helps them solve the problem themselves.",completed:!0},{day:2,title:"Growth Mindset Moment",description:'Add "yet" to any statement your child makes about not being able to do something.',completed:!0},{day:3,title:"Conversation Starter",description:"Practice a new conversation skill with your child in a low-pressure situation.",completed:!0},{day:4,title:"Strength Spotlight",description:"Point out a specific strength you notice in your child today.",completed:!0},{day:5,title:"Fear Reframe",description:"Help your child identify and reframe one fear or worry they have.",completed:!0},{day:6,title:"Problem-Solving Practice",description:"Present a small problem and guide your child through solving it independently.",completed:!1},{day:7,title:"Mistake Celebration",description:"Share a mistake you made and what you learned from it.",completed:!1},{day:8,title:"Social Scenario Practice",description:"Role-play a challenging social situation with your child.",completed:!1},{day:9,title:"Purpose Exploration",description:"Ask your child what activities make them feel happy and helpful.",completed:!1},{day:10,title:"Brave Step Challenge",description:"Encourage your child to take one small step toward something that makes them nervous.",completed:!1},{day:11,title:"Independent Task",description:"Identify one new responsibility your child can take on independently.",completed:!1},{day:12,title:"Effort Praise",description:"Focus exclusively on praising effort rather than results today.",completed:!1},{day:13,title:"Active Listening",description:"Practice active listening with your child for at least 10 minutes without interruption.",completed:!1},{day:14,title:"Strength in Action",description:"Create an opportunity for your child to use one of their strengths today.",completed:!1},{day:15,title:"Worry Detective",description:"Help your child investigate evidence for and against a worry they have.",completed:!1},{day:16,title:"Choice Menu",description:"Offer your child meaningful choices throughout the day.",completed:!1},{day:17,title:"Challenge Embrace",description:"Encourage your child to try something challenging and discuss how their brain grows from challenges.",completed:!1},{day:18,title:"Assertiveness Practice",description:"Help your child practice expressing their needs clearly and respectfully.",completed:!1},{day:19,title:"Values Exploration",description:"Discuss what matters most to your child and how they can live those values.",completed:!1},{day:20,title:"Relaxation Technique",description:"Teach your child a new relaxation technique to manage anxiety.",completed:!1},{day:21,title:"Problem-Solving Steps",description:"Guide your child through the formal steps of problem-solving for a current challenge.",completed:!1},{day:22,title:"Learning from Others",description:"Share a story about someone who overcame obstacles through persistence.",completed:!1},{day:23,title:"Empathy Builder",description:"Help your child practice understanding someone else's perspective.",completed:!1},{day:24,title:"Passion Project",description:"Help your child take one step forward on a project they're passionate about.",completed:!1},{day:25,title:"Gradual Exposure",description:"Create a small step toward facing something your child fears.",completed:!1},{day:26,title:"Self-Help Skills",description:"Teach your child one new self-help skill appropriate for their age.",completed:!1},{day:27,title:"Persistence Practice",description:"Encourage your child to stick with something difficult for a set period of time.",completed:!1},{day:28,title:"Conversation Challenge",description:"Challenge your child to start a conversation with someone new or ask questions to keep a conversation going.",completed:!1},{day:29,title:"Strength Celebration",description:"Have a special celebration of your child's unique strengths and qualities.",completed:!1},{day:30,title:"Confidence Reflection",description:"Reflect with your child on how they've grown in confidence over the past month.",completed:!1}]);Object(a.useEffect)((()=>{e&&e.children&&e.children.length>0&&s(e.children[0])}),[e]);return Object(d.jsx)("div",{className:"challenges-page",children:Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)("h1",{children:"Confidence Challenges"}),e&&e.children&&e.children.length>0?Object(d.jsxs)("div",{className:"child-selector",children:[Object(d.jsx)("label",{htmlFor:"childSelect",children:"Select Child: "}),Object(d.jsx)("select",{id:"childSelect",onChange:t=>{const a=t.target.value,c=e.children.find((e=>e.id===a));s(c)},value:null===t||void 0===t?void 0:t.id,children:e.children.map((e=>Object(d.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}):Object(d.jsx)("div",{className:"no-children-message",children:Object(d.jsx)("p",{children:"You haven't added any children to your profile yet."})}),t&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"challenges-tabs",children:[Object(d.jsx)("button",{className:"daily"===c?"active":"",onClick:()=>i("daily"),children:"Today's Challenge"}),Object(d.jsx)("button",{className:"calendar"===c?"active":"",onClick:()=>i("calendar"),children:"30-Day Calendar"})]}),Object(d.jsxs)("div",{className:"challenges-content",children:["daily"===c&&Object(d.jsx)("div",{className:"daily-challenge-tab",children:Object(d.jsxs)("div",{className:"dashboard-section",children:[Object(d.jsxs)("h2",{children:["Today's Challenge for ",t.name]}),Object(d.jsxs)("div",{className:"challenge-card",children:[Object(d.jsx)("h3",{children:l.title}),Object(d.jsx)("p",{children:l.description}),l.completed?Object(d.jsxs)("div",{className:"completed-message",children:[Object(d.jsx)("span",{className:"completed-badge",children:"Completed"}),Object(d.jsx)("p",{children:"Great job! Come back tomorrow for a new challenge."})]}):Object(d.jsx)("button",{className:"btn btn-primary",onClick:()=>{r({...l,completed:!0})},children:"Mark as Complete"})]}),Object(d.jsxs)("div",{className:"challenge-tips",children:[Object(d.jsx)("h3",{children:"Tips for Success"}),Object(d.jsxs)("ul",{children:[Object(d.jsx)("li",{children:"Try to complete the challenge early in the day"}),Object(d.jsx)("li",{children:"Explain to your child what you're doing and why"}),Object(d.jsx)("li",{children:"Take notes on what worked and what didn't"}),Object(d.jsx)("li",{children:"Be consistent with daily challenges for best results"})]})]})]})}),"calendar"===c&&Object(d.jsx)("div",{className:"calendar-challenge-tab",children:Object(d.jsxs)("div",{className:"dashboard-section",children:[Object(d.jsx)("h2",{children:"30-Day Confidence Challenge Calendar"}),Object(d.jsx)("p",{children:"Complete one challenge each day to build your child's confidence systematically."}),Object(d.jsxs)("div",{className:"challenge-progress",children:[Object(d.jsxs)("p",{children:[Object(d.jsx)("strong",{children:"Progress: "}),n.filter((e=>e.completed)).length," / 30 challenges completed"]}),Object(d.jsx)("div",{className:"progress-bar",children:Object(d.jsx)("div",{className:"progress-fill",style:{width:n.filter((e=>e.completed)).length/30*100+"%"}})})]}),Object(d.jsx)("div",{className:"calendar-challenges",children:n.map((e=>Object(d.jsxs)("div",{className:"calendar-day "+(e.completed?"completed":""),children:[Object(d.jsxs)("div",{className:"day-number",children:["Day ",e.day]}),Object(d.jsxs)("div",{className:"day-content",children:[Object(d.jsx)("h3",{children:e.title}),Object(d.jsx)("p",{children:e.description})]}),Object(d.jsx)("div",{className:"day-action",children:Object(d.jsx)("button",{className:"btn "+(e.completed?"btn-secondary":"btn-primary"),onClick:()=>{return t=e.day,void o(n.map((e=>e.day===t?{...e,completed:!e.completed}:e)));var t},children:e.completed?"Completed":"Mark Complete"})})]},e.day)))})]})})]})]})]})})};const R="https://confident-kids-api.kevin-mcgovern.workers.dev";var L=()=>{const{challengeId:e}=Object(r.s)(),t=Object(r.q)(),{user:s}=h(),[c,i]=Object(a.useState)(null),[l,n]=Object(a.useState)(!0),[o,j]=Object(a.useState)(null),[b,p]=Object(a.useState)(null);Object(a.useEffect)((()=>{s&&s.children&&s.children.length>0&&!b&&p(s.children[0].id)}),[s]),Object(a.useEffect)((()=>{(async()=>{if(s&&b)try{n(!0),j(null);const t=localStorage.getItem("authToken");if(!t)throw new Error("No authentication token found");const s=await fetch(`${R}/api/challenges/${e}`,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error("Failed to fetch challenge details");const a=await s.json();i(a)}catch(t){j(t.message)}finally{n(!1)}})()}),[e,s,b]);return s?l?Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"text-center p-5",children:"Loading challenge details..."})}):o?Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"alert alert-danger",children:o})}):c?Object(d.jsxs)("div",{className:"container mt-4",children:[Object(d.jsxs)("button",{className:"btn btn-outline-secondary mb-3",onClick:()=>t(-1),children:[Object(d.jsx)(m.a,{className:"me-2"})," Back to Challenges"]}),Object(d.jsxs)("div",{className:"daily-challenge",children:[s.children&&s.children.length>0&&Object(d.jsxs)("div",{className:"child-selector mb-4",children:[Object(d.jsx)("label",{htmlFor:"childSelect",children:"Select Child:"}),Object(d.jsx)("select",{id:"childSelect",className:"form-control",value:(null===b||void 0===b?void 0:b.id)||"",onChange:e=>{const t=e.target.value,a=s.children.find((e=>e.id===t));p(a)},children:s.children.map((e=>Object(d.jsxs)("option",{value:e.id,children:[e.name," (",e.age," years)"]},e.id)))})]}),Object(d.jsxs)("div",{className:"challenge-header",children:[Object(d.jsx)("h2",{children:c.title}),Object(d.jsxs)("div",{className:"challenge-meta",children:[Object(d.jsxs)("span",{className:"difficulty",children:[Object(d.jsx)(m.p,{})," ",1===c.difficulty_level?"Easy":2===c.difficulty_level?"Medium":"Hard"]}),Object(d.jsxs)("span",{className:"duration",children:[Object(d.jsx)(m.g,{})," 15-20 minutes"]}),Object(d.jsxs)("span",{className:"age-range",children:[Object(d.jsx)(m.t,{})," ","all"===c.age_group?"All Ages":c.age_group]})]})]}),Object(d.jsxs)("div",{className:"challenge-content",children:[Object(d.jsx)("p",{children:c.description}),Object(d.jsxs)("div",{className:"challenge-steps",children:[Object(d.jsx)("h4",{children:"Instructions for Parents:"}),Object(d.jsxs)("div",{className:"step",children:[Object(d.jsx)("span",{className:"step-number",children:"1"}),Object(d.jsx)("p",{children:"Find a quiet, comfortable space with your child"})]}),Object(d.jsxs)("div",{className:"step",children:[Object(d.jsx)("span",{className:"step-number",children:"2"}),Object(d.jsx)("p",{children:"Guide your child through the breathing exercise"})]}),Object(d.jsxs)("div",{className:"step",children:[Object(d.jsx)("span",{className:"step-number",children:"3"}),Object(d.jsx)("p",{children:"Practice together until your child feels comfortable"})]}),Object(d.jsxs)("div",{className:"step",children:[Object(d.jsx)("span",{className:"step-number",children:"4"}),Object(d.jsx)("p",{children:"Encourage your child to use this technique when needed"})]})]}),Object(d.jsxs)("div",{className:"challenge-rewards",children:[Object(d.jsx)("h4",{children:"Rewards"}),Object(d.jsxs)("ul",{children:[Object(d.jsxs)("li",{children:[Object(d.jsx)(m.p,{className:"reward-icon"}),"Builds emotional regulation skills"]}),Object(d.jsxs)("li",{children:[Object(d.jsx)(m.p,{className:"reward-icon"}),"Reduces anxiety and stress"]}),Object(d.jsxs)("li",{children:[Object(d.jsx)(m.p,{className:"reward-icon"}),"Strengthens parent-child bond"]})]})]}),Object(d.jsxs)("button",{className:`btn ${c.completed?"btn-secondary":"btn-primary"} complete-challenge`,onClick:async()=>{if(c&&b)try{const t=localStorage.getItem("authToken"),s=await fetch(`${R}/api/challenges/${e}/complete`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({childId:b,completed:!c.completed})});if(!s.ok)throw new Error("Failed to update challenge status");await s.json();i({...c,completed:!c.completed})}catch(t){j(t.message)}},children:[Object(d.jsx)(m.e,{})," ",c.completed?"Mark as Incomplete":"Complete Challenge"]})]})]})]}):Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"text-center p-5",children:"Challenge not found."})}):Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsx)("div",{className:"alert alert-warning",children:"Please log in to view challenge details."})})};const B=e=>{let{children:t}=e;const{currentUser:s}=h();return s?t:Object(d.jsx)(r.a,{to:"/login"})},q=e=>{let{children:t}=e;const{hasPremiumAccess:s}=h();return s()?t:Object(d.jsx)(r.a,{to:"/subscription"})},D=()=>{const{currentUser:e}=h();return Object(d.jsx)(r.a,{to:e?"/dashboard":"/"})};var z=()=>Object(d.jsx)(b,{children:Object(d.jsxs)(n.a,{children:[Object(d.jsx)(u,{}),Object(d.jsx)("main",{className:"main-content",children:Object(d.jsxs)(r.d,{children:[Object(d.jsx)(r.b,{path:"/login",element:Object(d.jsx)(O,{})}),Object(d.jsx)(r.b,{path:"/register",element:Object(d.jsx)(x,{})}),Object(d.jsx)(r.b,{path:"/dashboard",element:Object(d.jsx)(B,{children:Object(d.jsx)(g,{})})}),Object(d.jsx)(r.b,{path:"/pillars",element:Object(d.jsx)(B,{children:Object(d.jsx)(S,{})})}),Object(d.jsx)(r.b,{path:"/pillars/:pillarId",element:Object(d.jsx)(B,{children:Object(d.jsx)(w,{})})}),Object(d.jsx)(r.b,{path:"/challenges",element:Object(d.jsx)(B,{children:Object(d.jsx)(U,{})})}),Object(d.jsx)(r.b,{path:"/challenges/:challengeId",element:Object(d.jsx)(B,{children:Object(d.jsx)(L,{})})}),Object(d.jsx)(r.b,{path:"/subscription",element:Object(d.jsx)(B,{children:Object(d.jsx)($,{})})}),Object(d.jsx)(r.b,{path:"/rewards",element:Object(d.jsx)(B,{children:Object(d.jsx)(q,{children:Object(d.jsx)(I,{})})})}),Object(d.jsx)(r.b,{path:"/profile",element:Object(d.jsx)(B,{children:Object(d.jsx)(F,{})})}),Object(d.jsx)(r.b,{path:"/",element:Object(d.jsx)(D,{})})]})})]})});l.a.createRoot(document.getElementById("root")).render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(z,{})}))},7:function(e,t,s){}},[[24,1,2]]]);
//# sourceMappingURL=main.71cae880.chunk.js.map